// ==UserScript==
// @name         「百炼英雄」插件 - project
// @namespace    TemperedHeroes-Plugin/TemperedHeroes-Plugin
// @version      1.1.24
// @author       zzliux
// @description  百炼英雄辅助，支持抽卡、打肉、打金币、打副本、挂机领宝箱
// @icon         https://www.google.com/s2/favicons?sz=64&domain=boomegg.cn
// @homepageURL  https://github.com/TemperedHeroes-Plugin/TemperedHeroes-Plugin-TampermonkeyScript
// @supportURL   https://github.com/TemperedHeroes-Plugin/TemperedHeroes-Plugin-TampermonkeyScript/issues
// @downloadURL  https://github.com/TemperedHeroes-Plugin/TemperedHeroes-Plugin-TampermonkeyScript/raw/refs/heads/main/dist/%E3%80%8C%E7%99%BE%E7%82%BC%E8%8B%B1%E9%9B%84%E3%80%8D%E6%8F%92%E4%BB%B6%20-%20project.user.js
// @updateURL    https://github.com/TemperedHeroes-Plugin/TemperedHeroes-Plugin-TampermonkeyScript/raw/refs/heads/main/dist/%E3%80%8C%E7%99%BE%E7%82%BC%E8%8B%B1%E9%9B%84%E3%80%8D%E6%8F%92%E4%BB%B6%20-%20project.user.js
// @match        https://mprogram.boomegg.cn/box/game/wx77200645d1c7f35f/h5?appid=wx77200645d1c7f35f&game_platform=h5
// @require      https://registry.npmmirror.com/vue/3.5.13/files/dist/vue.global.prod.js
// @require      data:application/javascript,%3Bwindow.Vue%3DVue%3B
// @require      https://registry.npmmirror.com/element-plus/2.9.7/files/dist/index.full.min.js
// @require      https://registry.npmmirror.com/echarts/5.6.0/files/dist/echarts.js
// @require      https://registry.npmmirror.com/sortablejs/1.15.6/files/Sortable.min.js
// @resource     element-plus/dist/index.css  https://registry.npmmirror.com/element-plus/2.9.7/files/dist/index.css
// @grant        GM_addStyle
// @grant        GM_getResourceText
// @grant        GM_getValue
// @grant        GM_setValue
// @grant        unsafeWindow
// ==/UserScript==

(t=>{if(typeof GM_addStyle=="function"){GM_addStyle(t);return}const e=document.createElement("style");e.textContent=t,document.head.append(e)})(" .bet-card-log .el-dialog__footer,.bet-card-log .el-dialog__header{padding-top:0!important;padding-bottom:0!important}.setting-dialog-select .el-select-dropdown__item{text-align:left!important}.importLogContainer .el-textarea__inner{height:100%}.group[data-v-c8a59280]{width:max-content;margin-bottom:4px;float:right}.importLogContainer[data-v-c8a59280],.bet-card-log pre[data-v-c8a59280]{overflow:auto;height:calc(85vh - 260px);text-align:left;font-size:12px}.statisticsContainer[data-v-c8a59280]{overflow-x:hidden;height:calc(85vh - 214px);text-align:left}.group[data-v-b8add2e3]{width:max-content;margin-bottom:4px;float:right}.setting-dialog .el-dialog__footer{padding-top:0!important;padding-bottom:0!important}.group[data-v-35e5bcc4]{width:max-content;margin-bottom:4px;float:right}.centerPoint{position:fixed;width:10px;top:calc(50vh - 5px);left:calc(50vw - 5px);height:10px;background-color:#ff0;border-radius:50%}.group[data-v-9e5bca3f]{width:max-content;margin-bottom:4px;float:right}.dialog-content{display:flex;flex-direction:column;max-height:60vh}.settings-list{overflow-y:auto;flex:1;padding-right:8px}.setting-item{display:flex;align-items:center;margin-bottom:1px;padding:2px;background:#f5f7fa;border-radius:4px}.drag-handle{cursor:move;margin-right:10px;padding:0 8px;color:#909399}.name-text{margin:0 10px;text-align:left}.dynamic-btn-form-item{margin-bottom:10px}@media (max-width: 768px){.dialog-content{max-height:calc(100vh - 120px)}.setting-item{flex-wrap:wrap}}.path-viewer.el-dialog{padding:0;margin-right:0;pointer-events:auto}.path-viewer .el-dialog__header,.path-viewer .el-dialog__footer{padding:0}.path-viewer .el-dialog__headerbtn{width:22.5px;height:22.5px}.path-viewer-modal{pointer-events:none}.group[data-v-ee34aa69]{width:max-content;margin-bottom:4px;float:right}.zz-float-btn[data-v-ee34aa69]{position:fixed;bottom:10px;right:10px;width:30px;height:30px;border-radius:50%;background:#ff4757;color:#fff;border:0;cursor:pointer;font-size:18px;box-shadow:0 4px 12px #0003;transition:.3s;z-index:3001;outline:none;-webkit-user-select:none;user-select:none;align-items:center;justify-content:center;line-height:27px}.zz-sub-btns[data-v-ee34aa69]{position:fixed;bottom:40px;right:10px;opacity:0;transition:.3s;pointer-events:none;display:block;width:min-content;z-index:3001}.zz-sub-btns>button[data-v-ee34aa69]{margin-bottom:4px;float:right}.zz-show .zz-sub-btns[data-v-ee34aa69]{opacity:1;pointer-events:all}.zz-rotate[data-v-ee34aa69]{transform:rotate(45deg)!important} ");

(function (vue, Ot, Re, Yt) {
    'use strict';

    function _interopNamespaceDefault(e) {
        const n = Object.create(null, { [Symbol.toStringTag]: { value: 'Module' } });
        if (e) {
            for (const k in e) {
                if (k !== 'default') {
                    const d = Object.getOwnPropertyDescriptor(e, k);
                    Object.defineProperty(n, k, d.get ? d : {
                        enumerable: true,
                        get: () => e[k]
                    });
                }
            }
        }
        n.default = e;
        return Object.freeze(n);
    }

    const Re__namespace = /*#__PURE__*/_interopNamespaceDefault(Re);

    const Xt=t=>{const e=GM_getResourceText(t);return GM_addStyle(e),e};Xt("element-plus/dist/index.css");var L=typeof GM_getValue<"u"?GM_getValue:void 0,H=typeof GM_setValue<"u"?GM_setValue:void 0,P=typeof unsafeWindow<"u"?unsafeWindow:void 0;const _t=[{id:"81002",name:"莉莉",quality:"蓝"},{id:"81003",name:"布莱恩",quality:"灰"},{id:"82001",name:"杰克",quality:"蓝"},{id:"82002",name:"罗宾汉",quality:"蓝"},{id:"82003",name:"波派",quality:"蓝"},{id:"82005",name:"莱特宁",quality:"橙"},{id:"82006",name:"哈桑",quality:"蓝"},{id:"82007",name:"温蕾萨",quality:"蓝"},{id:"83001",name:"德古拉",quality:"橙"},{id:"83002",name:"克里冈",quality:"紫"},{id:"83003",name:"王昭君",quality:"橙"},{id:"83004",name:"奈辛瓦里",quality:"紫"},{id:"83006",name:"玛丽亚",quality:"紫"},{id:"83008",name:"麦克雷",quality:"紫"},{id:"83009",name:"克劳德",quality:"紫"},{id:"83011",name:"海森堡",quality:"紫"},{id:"83012",name:"洁萝露尔",quality:"紫"},{id:"83013",name:"狂鼠",quality:"紫"},{id:"83014",name:"蒙特祖马",quality:"紫"},{id:"83015",name:"阿宝",quality:"橙"},{id:"83017",name:"佐罗",quality:"紫"},{id:"83019",name:"弗罗斯特",quality:"紫"},{id:"83020",name:"奎托斯",quality:"紫"},{id:"83021",name:"琪琪",quality:"紫"},{id:"83022",name:"埃里克",quality:"紫"},{id:"83023",name:"拉格纳",quality:"紫"},{id:"83031",name:"吉尔",quality:"橙"},{id:"84001",name:"宫本武藏",quality:"橙"},{id:"84003",name:"亚瑟",quality:"橙"},{id:"84004",name:"阿狸",quality:"橙"},{id:"84005",name:"缘壹",quality:"橙"},{id:"84007",name:"熬丙",quality:"红"},{id:"84008",name:"雅丽娜",quality:"红"},{id:"84009",name:"拉斐尔",quality:"橙"},{id:"84011",name:"谢必安",quality:"橙"},{id:"84013",name:"乌瑟尔",quality:"红"},{id:"84014",name:"莉娜",quality:"橙"},{id:"84015",name:"阿萨斯",quality:"橙"},{id:"84016",name:"卡卡西",quality:"红"},{id:"84017",name:"达斯坦",quality:"红"},{id:"84018",name:"杜康",quality:"红"},{id:"84019",name:"甘道夫",quality:"橙"},{id:"84020",name:"维多利亚",quality:"橙"},{id:"84021",name:"威尔海姆",quality:"橙"},{id:"84022",name:"阿帕奇",quality:"紫"},{id:"84023",name:"嫦娥",quality:"橙"},{id:"84024",name:"一眉",quality:"橙"},{id:"84025",name:"塔纳托斯",quality:"橙"},{id:"84026",name:"戴维琼斯",quality:"橙"},{id:"84027",name:"美杜莎",quality:"橙"},{id:"84028",name:"塔拉萨",quality:"橙"},{id:"84029",name:"花木兰",quality:"红"},{id:"84030",name:"斯卡哈",quality:"橙"},{id:"85001",name:"李白",quality:"红"},{id:"85002",name:"玛法里奥",quality:"红"},{id:"85003",name:"孙悟空",quality:"红"},{id:"85004",name:"哪吒",quality:"红"},{id:"85007",name:"吕布",quality:"红"},{id:"85008",name:"关羽",quality:"白金"},{id:"85009",name:"诸葛亮",quality:"红"},{id:"85010",name:"孙尚香",quality:"红"},{id:"85012",name:"阿扎尔",quality:"红"},{id:"85015",name:"后羿",quality:"红"},{id:"85016",name:"贞德",quality:"红"},{id:"85019",name:"妮露",quality:"橙"},{id:"85020",name:"宙斯",quality:"红"},{id:"85021",name:"紫霞",quality:"橙"},{id:"85022",name:"芬里尔",quality:"红"},{id:"85026",name:"黄飞虎",quality:"橙"},{id:"85027",name:"阿卡多",quality:"红"},{id:"85028",name:"白",quality:"橙"},{id:"85029",name:"莉莎",quality:"红"},{id:"85031",name:"闻仲",quality:"红"},{id:"85041",name:"嬴政",quality:"红"},{id:"86001",name:"姜尚",quality:"白金"},{id:"83029",name:"银发",quality:"橙"},{id:"84033",name:"云雀",quality:"橙"},{id:"83027",name:"史矛革",quality:"橙"},{id:"83036",name:"正义队长",quality:"橙"},{id:"85046",name:"骸",quality:"红"},{id:"85043",name:"唐三藏",quality:"红"},{id:"85045",name:"逸菲",quality:"红"},{id:"84039",name:"金奥加",quality:"橙"},{id:"85044",name:"乔克琳",quality:"橙"},{id:"86002",name:"摩莉甘",quality:"白金"},{id:"85042",name:"至尊宝",quality:"红"},{id:"84044",name:"阿格娜",quality:"红"},{id:"84032",name:"白晶晶",quality:"橙"},{id:"84035",name:"春三十娘",quality:"橙"},{id:"83030",name:"卡尔",quality:"橙"}],st={};_t.forEach(t=>st[t.id]=t);const Kt=["灰","蓝","紫","橙","红","白金"].map(t=>({value:`quality:${t}`,label:`品阶:${t}`,children:_t.filter(e=>e.quality===t).map(e=>({value:`id:${e.id}`,label:`名称:${e.name}`}))}));function re(t){return !("type"in t)}function jt(t,e){let n=0,a=null,l=null;return function(...o){const i=Date.now(),r=i-n;if(r>=e)return n=i,t.apply(this,o);a={args:o,thisArg:this},l||(l=window.setTimeout(()=>{a&&(n=Date.now(),t.apply(a.thisArg,a.args),a=null),l=null;},e-r));}}const Ae=vue.ref(false),Pt=vue.ref();let Be=null;const xt=async()=>{Ae.value=true,await vue.nextTick(),Be=Re__namespace.init(Pt.value),Be.setOption({tooltip:{trigger:"item",formatter:function(t){return t.seriesName==="路径"?`(${Math.floor(t.data[0])}, ${Math.floor(t.data[1])})`:t.seriesName==="当前位置"?`(${Math.floor(t.data[0])}, ${Math.floor(t.data[1])})`:t.name}},xAxis:{show:false,min:"dataMin",max:"dataMax"},yAxis:{show:false,min:"dataMin",max:"dataMax"},grid:{left:"10px",top:"10px",right:"10px",bottom:"10px"},series:[]});};let Ve=[];const Jt=async t=>{const e=Ve.findIndex(n=>n.name==="当前位置");e!==-1?Ve[e].data=[[t.x,t.y]]:Ve.push({name:"当前位置",type:"scatter",data:[[t.x,t.y]],symbol:"pin",symbolSize:50,itemStyle:{color:"#EE2222"},label:{show:true,formatter:"队",position:"inside",color:"white"},emphasis:{disabled:true}}),Be==null||Be.setOption({series:Ve});},Zt=jt(Jt,200),Oe=async(t,e)=>{if(Ae.value||await xt(),!Be)throw Error("echarts instance error");const n=t.filter(re);Ve=[{name:"路径",type:"line",data:n.map(({x:a,y:l})=>[a,l]),symbol:"circle",symbolSize:8},{name:"起点",type:"scatter",data:[[n[0].x,n[0].y]],symbol:"pin",symbolSize:50,itemStyle:{color:"green"},label:{show:true,formatter:"起",position:"inside",color:"white"},emphasis:{disabled:true}},{name:"终点",type:"scatter",data:[[n[n.length-1].x,n[n.length-1].y]],symbol:"pin",symbolSize:50,itemStyle:{color:"blue"},label:{show:true,formatter:"终",position:"inside",color:"white"},emphasis:{disabled:true}}],e&&Ve.push({name:"当前位置",type:"scatter",data:[[e.x,e.y]],symbol:"pin",symbolSize:50,itemStyle:{color:"#EE2222"},label:{show:true,formatter:"队",position:"inside",color:"white"},emphasis:{disabled:true}}),Be.setOption({series:Ve});};window.showPathViewer=xt;window.setPathViewerData=Oe;let _,ye=document.getElementById("zz-iframe-console");if(ye){if(!ye.contentWindow)throw new Error("iframe.contentWindow not found");_=ye.contentWindow.console;}else {ye=document.createElement("iframe"),ye.id="zz-iframe-console",document.body.appendChild(ye);const t=ye.contentWindow;if(!t)throw new Error("contentWindow not found");_=t.console,ye.style.display="none";}P.csl=_;(async()=>{var t,e;if(/mobile.+safari/ig.test(navigator.userAgent)){const n=await It('img[src="https://ad-static.boomegg.cn/operation/image/IOS引导图.png"]');n&&(_.log("检测到引导图，移除引导图"),(e=(t=n.parentElement)==null?void 0:t.parentElement)==null||e.remove());}})();function ut(t){return new Promise((e,n)=>{const a=document.createElement("textarea");a.value=t,a.style.position="fixed",a.style.left="-9999px",a.style.top="0",document.body.appendChild(a),a.select();try{const l=document.execCommand("copy");if(document.body.removeChild(a),l)console.log("复制成功"),e();else throw new Error("复制命令执行失败")}catch(l){document.body.removeChild(a),console.error("无法复制文本: ",l),n(l);}})}P.copyToClipboard=ut;async function It(t,e){e=e||3e4;const n=Date.now();for(;Date.now()<=n+e;){const a=document.querySelector(t);if(a)return a;await m(200);}return null}P.waitForDom=It;function ve(t){var R;const e=t.getComponent(P.cc.UITransformComponent);if(!e)throw new Error("uiTransform not found");const n=t.worldPosition,{width:a,height:l}=e.contentSize,o=a/2,i=l/2,r=new P.cc.Vec3(n.x-o,n.y+i,n.z),v=new P.cc.Vec3(n.x+o,n.y-i,n.z),s=(R=P.cc.find("Root/UIScene/UICamera"))==null?void 0:R.getComponent(P.cc.Camera);if(!s)throw new Error("camera not found");const w=s.worldToScreen(r),b=s.worldToScreen(v),S=document.querySelector("#GameCanvas");if(!S)throw new Error("domCanvas not found");const C=S.getBoundingClientRect(),d=C.width/S.width,x=C.height/S.height,B=w.x*d,g=(S.height-w.y)*x,E=b.x*d,T=(S.height-b.y)*x;return {x:C.left+B,y:C.top+g,width:E-B,height:T-g}}P.getUIDomPosition=ve;let de=null,ke=null;function Te(t,e){e=e||0,ke!==null&&(clearTimeout(ke),ke=null),de||(de=document.createElement("div"),de.style.cssText=`
        position: absolute;
        border: 2px solid red;
        pointer-events: none;
        z-index: 9999;
    `,document.body.appendChild(de)),de.style.left=t.x+"px",de.style.top=t.y+"px",de.style.width=Math.floor(t.width-4)+"px",de.style.height=Math.floor(t.height-4)+"px",de.style.display="block",e>0&&(ke=setTimeout(()=>{de&&(de.style.display="none"),ke=null;},e));}P.updateDebugRect=Te;async function m(t){return new Promise(e=>{setTimeout(()=>{e();},t);})}P.delay=m;async function Q(t,e,n){e=e||false,n=n||3e4;const a=Date.now();do{const l=y(t);if(l&&l.active&&l.activeInHierarchy)if(e){if(l.scale.x===1&&l.scale.y===1)return l}else return l;await m(20);}while(Date.now()<a+n);throw new Error(`find path: [${t}] timeout in ${n}ms`)}P.waitForNodeActive=Q;async function Qt(t,e,n){e=e||false,n=n||3e4;const a=Date.now();do{if(t&&t.active&&t.activeInHierarchy)if(e){if(t.scale.x===1&&t.scale.y===1)return t}else return t;await m(20);}while(Date.now()<a+n);throw new Error(`find node: [${pt(t)}] timeout in ${n}ms`)}P.waitForNodeActive2=Qt;function se(t,e){return Math.floor(Math.random()*(e-t+1))+t}P.random=se;async function A(t,e){const n=ve(t);await Ke(n,e);}P.nodePress=A;async function Ke(t,e){e=e||se(100,300),Te(t,e);const n=se(t.x+t.width/4,t.x+t.width*3/4),a=se(t.y+t.height/4,t.y+t.height*3/4),l=new MouseEvent("mousedown",{clientX:n,clientY:a}),o=document.querySelector("#GameCanvas");o==null||o.dispatchEvent(l),await m(e);const i=new MouseEvent("mouseup",{clientX:n,clientY:a});o==null||o.dispatchEvent(i),await m(e);}P.rectPress=Ke;async function nt(t,e){e=e||se(100,300);const n=ve(t);Te(n,e),t.emit(P.cc.Node.EventType.TOUCH_START),await m(e),t.emit(P.cc.Node.EventType.TOUCH_END),await m(e);}P.nodeEventPress=nt;function y(t,e){e||(e=P.cc.director.getScene());const n=t.split("/");let a=e;for(const l of n){if(!a)break;const o=l.match(/(.+?)(?:\[(\d+)\])?$/);if(!o)continue;const i=o[1],r=o[2]?parseInt(o[2],10):-1,v=a.children;let s=null;if(r>=0){const w=v.filter(b=>b.name===i);if(r<w.length)s=w[r];else return _.error(`[findWithIndex] 索引超出范围：${i}[${r}]`),null}else s=a.getChildByName(i);a=s;}return a}P.ccFind=y;function Fe(t,e){const n=ct(e,300);return tn(t,n)}P.planPath=Fe;function ct(t,e){if(t.length===0)return [];const n=new Array(t.length).fill(false),a=[];for(let o=0;o<t.length;o++){if(n[o])continue;const i=[],r=[o];for(;r.length>0;){const v=r.shift();if(!n[v]){n[v]=true,i.push(t[v]);for(let s=0;s<t.length;s++)!n[s]&&Ue(t[v],t[s])<=e&&r.push(s);}}a.push(i);}return a.map(o=>{let i=0,r=0;return o.forEach(v=>{i+=v.x,r+=v.y;}),{x:i/o.length,y:r/o.length}})}P.clusterMonsters=ct;function Ue(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function en(t,e,n){const a=t.x-e.x,l=t.y-e.y,o=n.x-e.x,i=n.y-e.y,r=a*o+l*i,v=o*o+i*i;let s=-1;v!==0&&(s=r/v);let w,b;s<0?(w=e.x,b=e.y):s>1?(w=n.x,b=n.y):(w=e.x+s*o,b=e.y+s*i);const S=t.x-w,C=t.y-b;return Math.sqrt(S*S+C*C)}function tn(t,e){if(e.length===0)return [];const n=[t],a=[...e];for(;a.length>0;){const l=n[n.length-1];let o=0,i=Ue(l,a[0]);for(let r=1;r<a.length;r++){const v=Ue(l,a[r]);v<i&&(i=v,o=r);}n.push(a[o]),a.splice(o,1);}return n.slice(1)}function dt(){var n,a,l,o;const t=st,e=[];for(let i=1;i<=3;i++){const r=`Root/UIScene/UICanvas/Content/PubMainView/Content/Panel/PubView/Content/Stage/HeroBox/hero${i}/Panel/HeroBox/PubHeroNode/Animation/Sprite`,v=(l=(a=(n=y(r))==null?void 0:n.getComponents(P.cc.Sprite)[0])==null?void 0:a.spriteFrame)==null?void 0:l.name;if(!v){e.push({id:"UNKOWN",name:"UNKOWN",quality:"UNKOWN"});continue}const s=(o=v.match(/^Hero(\d{5})/))==null?void 0:o[1];t[s]?e.push(t[s]):e.push({id:s,name:s,quality:"UNKOWN"});}return e}P.getBetCardHeroQuality=dt;function ue(){const t=y("Root/GameScene/GameMapCanvas/MapView/TileMap/unitLayer/TeamUnit");if(!t)return null;const{x:e,y:n}=t.position;return {x:e,y:n}}P.getTeamPosition=ue;function _e(t,e,n,a){if(typeof n>"u"||typeof a>"u"){const o=ue();n=o.x,a=o.y;}return Math.sqrt(Math.pow(t-n,2)+Math.pow(e-a,2))<30}P.nearBy=_e;let be;function je(){if(!be&&(be=document.querySelector("#GameCanvas"),!be))throw new Error("canvasDom not found")}let Ie=false,z=false;async function Pe(t,e,n=0){if(Ie)throw new Error("正在移动，请勿重复调用");if(_e(t,e))return;Ie=true,je();const a=be.clientWidth,l=be.clientHeight;let o=a/2+se(-25,25),i=l*3/4+se(-25,25);await m(10),he(o,i),await m(10);const r=se(60,110);await new Promise((v,s)=>{let w=[],S=0;const C=Date.now(),d=setInterval(()=>{try{const x=ue(),B=Math.sqrt(Math.pow(x.x-t,2)+Math.pow(x.y-e,2));_.log(`当前: (${Math.round(x.x)}, ${Math.round(x.y)}), 目标: (${Math.round(t)}, ${Math.round(e)}), 距离: ${Math.round(B)}`),Zt(x),w.push({x:Math.floor(x.x),y:Math.floor(x.y)}),w.length>5&&w.shift();const g=t-x.x,E=x.y-e,T=Math.sqrt(g*g+E*E),R=g/T*r,p=E/T*r,h=Math.round(o+R),c=Math.round(i+p);Date.now()-C>10*1e3&&(clearInterval(d),me(h,c),Ie=!1,s("moveToXY: 超时")),z&&(clearInterval(d),me(h,c),z=!1,Ie=!1,s("中断本次移动")),ze(h,c),w.length===5&&(new Set(w.map(I=>`${I.x},${I.y}`)).size<=2?S++:S=0,S>=5&&(clearInterval(d),me(h,c),Ie=!1,n>=3?s("moveToXY: 卡住了，出不来"):(_.log("moveToXY: 似乎卡住了，准备重试"),setTimeout(()=>{Pe(t,e,n+1).then(v).catch(s);},800)))),_e(t,e)&&(clearInterval(d),me(h,c),v());}catch(x){clearInterval(d),Ie=false,s(x);}},100);}),Ie=false;}P.moveToXY=Pe;function he(t,e){je();const n=new MouseEvent("mousedown",{clientX:t,clientY:e});be.dispatchEvent(n),Te({x:t-4,y:e-4,width:7,height:7},102);}P.eventDown=he;function ze(t,e){je();const n=new MouseEvent("mousemove",{clientX:t,clientY:e});be.dispatchEvent(n),Te({x:t-4,y:e-4,width:7,height:7},102);}P.eventMove=ze;function me(t,e){je();const n=new MouseEvent("mouseup",{clientX:t,clientY:e});be.dispatchEvent(n),Te({x:t-4,y:e-4,width:7,height:7},102);}P.eventUp=me;async function Je(t){var C,d,x,B;const e=mt();if(z)throw z=false,Error("点击中断");await Ke(e);const n=await Q("Root/UIScene/UICanvas/Popup/TeleportSelectView/TabPagePanel/Bg/TabPanel/CommonListView/view/content");let a=null;if(!n)throw Error("tabPageBtnContent can not find");for(let g=0;g<n.children.length;g++)y("Text",n.children[g]).getComponent(P.cc.LabelComponent).string===t.target[0]&&(a=n.children[g]);if(!a)throw Error(`${t.target[0]} is not valid value`);await A(a);const l=y("Root/UIScene/UICanvas/Popup/TeleportSelectView/TabPagePanel/Bg/Panel").children;let o=null;for(let g=0;g<l.length;g++)if(l[g].active&&l[g].activeInHierarchy){o=y("PlaceScrollView/view/content",l[g]);break}if(!o)throw Error(`${t.target[1]} is not valid value. [101]`);let i=o.children.find(g=>{const E=y("PlaceName",g);return E?E.getComponent(P.cc.Label).string===t.target[1]:false});if(_.log(i),!i){const g=o.children,E=ve(g[g.length-4]),T={x:E.x+E.width/2,y:E.y+E.height/2};if(z)throw z=false,Error("点击中断");he(T.x,T.y),await m(200),ze(T.x,Math.max(T.y-500,1)),await m(500),me(T.x,Math.max(T.y-500,1)),await m(500),i=o.children.find(R=>{const p=y("PlaceName",R);return p?p.getComponent(P.cc.Label).string===t.target[1]:false});}if(!i)throw Error(`${t.target[1]} is not valid value. [102]`);if(z)throw z=false,Error("点击中断");await nt(i),await m(100);const r=y("Root/UIScene/UICanvas/Popup/TeleportSelectView/TabPagePanel/Bg/Panel").children;let v=null;for(let g=0;g<r.length;g++)if(r[g].active&&r[g].activeInHierarchy){v=y("TeleportScrollView/view/content",r[g]);break}if(!v)throw Error(`${t.target[1]} is not valid value. [101]`);let s=v.children.sort((g,E)=>E.worldPosition.y-g.worldPosition.y);if(!s)throw Error(`${t.target[2]} is not valid value[1]`);let w=s.find(g=>{const E=y("Name",g);return (E==null?void 0:E.getComponent(P.cc.Label).string)===t.target[2]});if(!w){if(s.length<6)throw Error(`${t.target[2]} is not valid value[2]`);let g=true;for(;g;){const E=ve(s[s.length-2]),T={x:Math.floor(E.x+E.width/2),y:Math.floor(E.y+E.height/2)},R=ve(s[0]),p={x:R.x+R.width/2,y:R.y+R.height/2};if(_.log("右侧翻页"),z)throw z=false,Error("点击中断");he(T.x,T.y),await m(500),ze(p.x,p.y),await m(500),me(p.x,p.y),await m(500);const h=(d=(C=y("Name",s[s.length-1]))==null?void 0:C.getComponent(P.cc.Label))==null?void 0:d.string;if(s=v.children.sort((W,I)=>I.worldPosition.y-W.worldPosition.y),w=s.find(W=>{const I=y("Name",W);return (I==null?void 0:I.getComponent(P.cc.Label).string)===t.target[2]}),w)break;const c=(B=(x=y("Name",s[s.length-1]))==null?void 0:x.getComponent(P.cc.Label))==null?void 0:B.string;if(h===c){g=false,_.error("翻到最后了，没有找到");break}}}if(!w)throw Error(`${t.target[2]} is not valid value[3]`);let b=ue();if(b.x=Math.floor(b.x),b.y=Math.floor(b.y),z)throw z=false,Error("点击中断");await nt(w),await m(500);const S=Date.now();for(;Date.now()-S>3e4;){await m(500);const g=ue();if(g&&(g.x=Math.floor(g.x),g.y=Math.floor(g.y),g.x!==b.x||g.y!==b.y))break}if(z)throw z=false,Error("点击中断");await Q("Root/GameScene/OperationCanvas/MapButtonView/BuildingButton01"),await m(200);}P.teleport=Je;async function Ze(t,e=false){if(t.length<2)throw new Error("路径至少需要2个点");const n=ue();if(!n)throw new Error("无法获取当前位置");const{segmentIndex:a,minDistance:l}=We(n,t);let o=a+1;l>3e3&&(o=0),Oe(at(o,t));for(let i=o;i<t.length;i=e?(i+1)%t.length:i+1){const r=t[i];Oe(at(i,t)),re(r)?await Pe(r.x,r.y):r.type==="backHome"?await Qe():r.type==="teleport"&&await Je(r),await St(["Idle","Gather","Move","Die"]),await m(200);}}P.movePath=Ze;function at(t,e){let n=t;for(;n>0&&re(e[n]);)n--;let a=t;for(;a<e.length-1&&re(e[a]);)a++;return e.slice(n,a+1)}async function Ge(t,e,n=false){if(t.length<2)throw new Error("路径至少需要2个点");for(;e.value;){const a=t.map(S=>({...S})),l=y("/Root/GameScene/GameMapCanvas/MapView/TileMap/unitLayer").children.filter(S=>{var C,d,x;if(/^Monster|^Boss/i.test(S.name)){const B=(x=(d=(C=y("AnimBox/Animation/Sprite",S))==null?void 0:C.getComponent(P.cc.Sprite))==null?void 0:d.spriteFrame)==null?void 0:x.name;if(B&&!/[\-_]Die/i.test(B))return  true}return  false}).map(S=>({x:S.position.x,y:S.position.y})),o=ct(l,100);_.log("clusterPts",o),o.forEach(S=>{const{segmentIndex:C,minDistance:d}=We(S,a);if(d<510&&d>180)a.splice(C+1,0,S);else if(d<=180&&C<a.length-1){const x=a[C],B=a[C+1];if(!re(x)||!re(B))return;const g=Ue(S,x),E=Ue(S,B);g>=180&&E>=180&&a.splice(C+1,0,S);}});const i=ue(),{segmentIndex:r,minDistance:v}=We(i,a);let s;const w=a[0];if(n&&re(w)&&_e(i.x,i.y,w.x,w.y))s=1;else {for(v>=3e3?s=0:s=r+1;s<a.length;){const S=a[s];if(!re(S)||!_e(i.x,i.y,S.x,S.y))break;s++;}if(n&&s>=a.length)s=0;else if(s>=a.length)break}_.log("path",t),_.log("newPath",a),_.log("startIndex",s),_.log("currentPos",i),_.log("nextPos",a[s]),Oe(at(s,a));const b=a[s];if(re(b)?await Pe(b.x,b.y):b.type==="backHome"?await Qe():b.type==="teleport"&&await Je(b),!n&&!re(b)&&s===a.length-1)break;await St(["Idle","Gather","Move","Die"]),await m(200);}}P.movePathWithMonster=Ge;function ft(t){const e=new RegExp(t.join("|"),"i");return !y("Root/GameScene/GameMapCanvas/MapView/TileMap/unitLayer").children.filter(n=>{var a,l,o;if(/^HeroUnit/i.test(n.name)){const i=(o=(l=(a=y("AnimBox/Animation/Sprite",n))==null?void 0:a.getComponent(P.cc.Sprite))==null?void 0:l.spriteFrame)==null?void 0:o.name;if(!e.test(i))return  true}return  false}).length}P.isHerosStatus=ft;async function St(t,e=15e3){const n=Date.now();for(;;){if(z)throw z=false,Error("点击中断");let a=false;const l=Date.now();for(;!a&&ft(t);){if(Date.now()-l>=120){a=true;break}await m(100);}if(a){_.log(`等待英雄状态${t}完成`);break}if(Date.now()-n>e){_.error("等待英雄状态超时");break}await m(30);}}function We(t,e){let n=1/0,a=-1;for(let l=0;l<e.length-1;l++){const o=e[l],i=e[l+1];if(!re(o)||!re(i))continue;Ue(o,i);const r=en(t,o,i);r<n&&(n=r,a=l);}return {segmentIndex:a,minDistance:n}}P.getPathStartIndex=We;function J(){z=true,setTimeout(()=>{z=false;},5e3);}P.setMoveInterrupt=J;async function Vt(t,e,n){n=n||3e4;const a=Date.now();do{try{if(_e(t,e))return !0}catch{}await m(500);}while(Date.now()<a+n);throw new Error(`等待坐标(${Math.floor(t)}, ${Math.floor(e)})超时`)}P.waitForPosition=Vt;async function ot(t,e){e=e||3e4;const n=Date.now();do{try{for(let a=0;a<t.length;a++){const{x:l,y:o}=t[a];if(_e(l,o))return a}}catch{}await m(500);}while(Date.now()<n+e);return  -1}P.waitForPositions=ot;function mt(){const t=document.querySelector("#GameCanvas"),e=y("Root/GameScene/OperationCanvas/MapButtonView/");if(!e)throw new Error("mapButtonView not found");const n=e.children.filter(a=>a.active&&a.activeInHierarchy).map(a=>{const l=ve(a);l.y-=l.height/2;const o=t.clientWidth/2+l.width/2,i=t.clientHeight/2-l.height*3/2;return {ele:a,distance:Math.sqrt((l.x-o)**2+(l.y-i)**2),...l}}).sort((a,l)=>a.distance-l.distance);if(n&&!n.length)throw new Error("未找到中心放大镜");return n[0]}P.getNearestMagnifierRect=mt;async function Qe(){const t=y("Root/UIScene/UICanvas/Menu/MenuView/SaveArea/DownRight/BackHomeMenuIconView");if(t&&t.active){if(z)throw z=false,Error("点击中断");await A(t);try{const e=await Q("Root/UIScene/UICanvas/Popup/ConfirmPopup/Popup/PanelHasTitle/Panel/BtnLay/BigButtonGreen",!0,3e3);if(await m(200),z)throw z=!1,Error("点击中断");await A(e),await m(200);}catch{_.error("未找到确认按钮，可能无需确认就直接回城了");}await Vt(-7089,-5605),await Q("Root/GameScene/OperationCanvas/MapButtonView/BuildingButton01");}else try{await Pe(-7089,-5605);}catch(e){throw alert("返回城镇失败"),e}}P.backHome=Qe;function Bt(t,e,n=[]){t.hasEventListener(e)&&n.push(t);const a=t.children;for(let l=0;l<a.length;l++)Bt(a[l],e,n);return n}const Et=()=>Bt(P.cc.director.getScene(),P.cc.Node.EventType.TOUCH_END);P.getAllHasTouchEventNode=Et;const nn=()=>{_.log(Et().map(t=>pt(t)).join(`
`));};P.printAllHasTouchEventNode=nn;const an=()=>{const t=y("Root/GameScene/GameMapCanvas/MapView/TileMap/unitLayer");_.log(t.children.filter(e=>e.active&&e.activeInHierarchy).map(e=>pt(e)).join(`
`));};P.printAllUnitLayerChildren=an;const on=()=>{};P.test=on;function pt(t){let e=t.name,n=t.parent;for(;n;)e=`${n.name}/${e}`,n=n.parent;return e}let ge=null;function Ut(){ge&&(ge.innerHTML="");}function ln(t){ge||(ge=document.createElement("div"),ge.style.cssText=`
            position: fixed;
            left: calc(50vw - 12px);
            top: calc(50vh - 12px);
            transform: translate(-50%, -50%);
            pointer-events: none;
            z-index: 9998;
        `,document.body.appendChild(ge)),Ut(),t.forEach(e=>{const n=document.createElement("div"),a=document.createElement("div");n.style.cssText=`
            position: absolute;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 28px solid rgba(105, 42, 6, 0.95);
            transform-origin: center bottom;
            left: 6px;
            top: 3px;
            z-index: 3;
        `,a.style.cssText=`
            position: absolute;
            width: 0;
            height: 0;
            border-left: 12px solid transparent;
            border-right: 12px solid transparent;
            border-bottom: 32px solid rgba(255, 255, 255, 1);
            transform-origin: center bottom;
            z-index: 2;
        `;const l=Math.atan2(e.y,e.x)*180/Math.PI;n.style.transform=`rotate(${l}deg) translateY(-50px)`,a.style.transform=`rotate(${l}deg) translateY(-50px)`,ge.appendChild(n),ge.appendChild(a);});}P.setDirectAssists=ln;P.clearDirectAssists=Ut;function rn(){const t=y("Root/UIScene/UICanvas/Transition");return !!(t!=null&&t.children&&(t==null?void 0:t.children.length)>1)}/*! Element Plus Icons Vue v2.3.1 */var sn=vue.defineComponent({name:"InfoFilled",__name:"info-filled",setup(t){return (e,n)=>(vue.openBlock(),vue.createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[vue.createElementVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64m67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344M590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"})]))}}),Tt=sn;const N=vue.ref(false),Se=vue.ref(false),ne=vue.ref(""),ae=vue.ref(),un=["关","次数","时间"];let De=true,lt=0,Mt=0;const cn=()=>{De=true,lt=0,Mt=Date.now();};async function dn(){const t=["Root/UIScene/UICanvas/Content/PubMainView/Content/Panel/PubView/Content/Stage/HeroBox/hero1/Panel/HeroBox/Ribbon_down","Root/UIScene/UICanvas/Content/PubMainView/Content/Panel/PubView/Content/Stage/HeroBox/hero2/Panel/HeroBox/Ribbon_down","Root/UIScene/UICanvas/Content/PubMainView/Content/Panel/PubView/Content/Stage/HeroBox/hero3/Panel/HeroBox/Ribbon_down"],e=8e3+Date.now();for(;Date.now()<e;){for(let n=0;n<t.length;n++){const a=y(t[n]);if(a&&a.active&&a.activeInHierarchy)return n}await m(200);}return  -1}const kt=()=>{const t=dt();let e=false;const n=L("betCardTripleList",[]);for(let a=0;a<t.length;a++){for(let l=0;l<n.length;l++){const[o,i]=n[l].split(":");if((o==="id"||o==="quality")&&t[a][o]===i){e=true;break}}if(e)break}return e};async function fn(){var e;let t=1;for(;t--;)try{const n=y("Root/UIScene/UICanvas/Top/SystemConfirmPopupView/Popup/PanelHasTitle/Panel/noTipToggle/Floor"),a=y("Root/UIScene/UICanvas/Top/SystemConfirmPopupView/Popup/PanelHasTitle/Panel/BtnLay/BigButtonGreen");if(n&&n.active&&n.activeInHierarchy){if(!N.value)return;await A(n),await m(200);}if(a&&a.active&&a.activeInHierarchy){if(!N.value)return;await A(a),await m(200);}const l=await Q("/Root/UIScene/UICanvas/Content/PubMainView/Content/Panel/PubView/Content/Stage/BottomLayout/PubRecruitButtonView/ButtonBox/BigButtonHasProp",!0),i=((e=y("Root/UIScene/UICanvas/Content/PubMainView/Content/Panel/PubView/Content/Stage/BottomLayout/PubRecruitButtonView/ButtonBox/BigButtonHasProp/Img/PropNode/Icon"))==null?void 0:e.getComponents(P.cc.Sprite)[0]).targetFramePath;let r=y("/Root/UIScene/UICanvas/Content/PubMainView/Content/Panel/PubView/Content/Stage/BottomLayout/PubRecruitButtonView/LabelBox/GiveUpButton");if(i==="System/Currency/ResourceIcon/88/spriteFrame")r&&(!r.active||!r.activeInHierarchy)&&await Q("/Root/UIScene/UICanvas/Content/PubMainView/Content/Panel/PubView/Content/Stage/BottomLayout/PubRecruitButtonView/LabelBox/GiveUpButton");else if(i!=="System/Currency/ResourceIcon/1/spriteFrame")throw new Error("未知的抽卡按钮");if(await m(50),r&&r.active&&r.activeInHierarchy){if(!N.value)return;await A(r),_.log("点击放弃"),t++;}else {const v=kt(),s=dt();if(v){if(!N.value)return;const b=await Q("/Root/UIScene/UICanvas/Content/PubMainView/Content/Panel/PubView/Content/Stage/BottomLayout/PubRecruitButtonView/BetNode/maxButton",!0);if(!N.value||(await m(50),b&&await A(b),await m(200),!N.value))return;await A(l);}else {if(!N.value)return;await A(l);}const w=await dn();if(w!==-1){let b=L("betCardLog","");const S=`[抽卡][${v?"三倍":"普通"}]	([${s[0].quality}][${s[0].name}],[${s[1].quality}][${s[1].name}],[${s[2].quality}][${s[2].name}])	抽中[${w+1}][${s[w].quality}][${s[w].name}]`;_.log(S),b+=S+`
`,Se.value&&ae.value&&(ne.value=b,vue.nextTick(()=>{if(ae.value){const x=ae.value.scrollLeft;ae.value.scrollTo(0,ae.value.scrollHeight),ae.value.scrollLeft=x;}})),H("betCardLog",b),lt++;let C="";if(L("betCardAutoStop")==="次数"){let B=L("betCardAutoStopCount")-lt;if(C=`，剩余[${B}]次`,B<=0){N.value=!1,Ot.ElMessage("达到次数停止");return}}else if(L("betCardAutoStop")==="时间"){let x=L("betCardAutoStopTime"),B=Math.max(x-Math.floor((Date.now()-Mt)/1e3),0);if(B<=0){N.value=!1,Ot.ElMessage("达到时间停止");return}C=`，剩余[${B}]秒`;}const d=`抽中[${w+1}][${s[w].quality}][${s[w].name}]${C}`;Ot.ElMessage(d);}}await m(200);}catch(n){_.error(n),await m(200);}}const tt=()=>{var n;const t=(n=y("Root/UIScene/UICanvas/Popup/PubAutoRecruitDisplayView/Content/rewardBg/ScrollView/view/content"))==null?void 0:n.children.map(a=>{var i,r;const l=(r=(i=y("Content/propItem/content/propIcon",a))==null?void 0:i.getComponent(P.cc.Sprite))==null?void 0:r.targetFramePath,o=l==null?void 0:l.match(/HeroIcon\/(\d+?)\//);return (o==null?void 0:o[1])||"UNKNOWN"}).map(a=>{let l="";if(a!=="UNKNOWN"){const o=st[a];o?l=`[抽卡][自动]	([.][.],[.][.],[.][.])	抽中[.][${o.quality}][${o.name}]`:l="[抽卡][自动]	([.][.],[.][.],[.][.])	抽中[.][UNKNOWN][UNKNOWN]";}return l}).join(`
`);let e=L("betCardLog","");e+=t+`
`,Se.value&&ae.value&&(ne.value=e,vue.nextTick(()=>{if(ae.value){const a=ae.value.scrollLeft;ae.value.scrollTo(0,ae.value.scrollHeight),ae.value.scrollLeft=a;}})),_.log(t),H("betCardLog",e);},mn=async()=>{var t,e,n,a,l;if(De)for(;;){if(!N.value)return;if(((e=(t=y("Root/UIScene/UICanvas/Top/ToastPopup/center/LabelToastItem/txt"))==null?void 0:t.getComponent(P.cc.Label))==null?void 0:e.string)==="符合筛选条件的英雄已经出现"){const d=y("Root/UIScene/UICanvas/Popup/PubAutoRecruitSettingView/Content/Popup/Bottom/CloseTips");if(d&&d.active&&d.activeInHierarchy){if(!N.value)return;await m(50),await A(d),await m(200);return}await m(200);return}const o=y("Root/UIScene/UICanvas/Popup/ConfirmPopup/Popup/PanelHasTitle/Panel/BtnLay/BigButtonGreen");if(o&&o.active&&o.activeInHierarchy){if(tt(),!N.value)return;await m(50),await A(o),await m(200);return}const i=y("Root/UIScene/UICanvas/Popup/PubAutoRecruitDisplayView/Content/rewardBg/Bottom/closeTip");if(i&&i.active&&i.activeInHierarchy){const d=(n=i.getComponent(P.cc.Label))==null?void 0:n.string;if(d&&d.includes("今日已达自动招募上限")){if(tt(),!N.value)return;await m(50),await A(i),await m(200),De=false;return}if(d&&d.includes("当次招募次数已满，请再次操作招募。")){if(tt(),!N.value)return;await A(i),await m(50),await m(500);continue}}const r=y("Root/UIScene/UICanvas/Top/SystemConfirmPopupView/Popup/PanelHasTitle/Panel/noTipToggle/Floor"),v=y("Root/UIScene/UICanvas/Top/SystemConfirmPopupView/Popup/PanelHasTitle/Panel/BtnLay/BigButtonGreen");if(r&&r.active&&r.activeInHierarchy){if(!N.value)return;await m(50),await A(r),await m(200);}if(v&&v.active&&v.activeInHierarchy){if(!N.value)return;await m(50),await A(v),await m(200);continue}let s=y("/Root/UIScene/UICanvas/Content/PubMainView/Content/Panel/PubView/Content/Stage/BottomLayout/PubRecruitButtonView/LabelBox/GiveUpButton");if(s&&s.active&&s.activeInHierarchy&&await Q("/Root/UIScene/UICanvas/Content/PubMainView/Content/Panel/PubView/Content/Stage/BottomLayout/PubRecruitButtonView/ButtonBox/BigButtonHasProp",true)){if(!N.value)return;await m(50),await A(s),await m(200);continue}const w=y("Root/UIScene/UICanvas/Content/PubMainView/Content/Panel/PubView/Content/Stage/HeroBox/hero3/Panel/HeroBox/PubHeroNode/Animation/Sprite");if(w&&w.active&&w.activeInHierarchy){const d=y("/Root/UIScene/UICanvas/Content/PubMainView/Content/Panel/PubView/Content/Stage/BottomLayout/PubRecruitButtonView/ButtonBox/BigButtonHasProp");if(d&&d.active&&d.activeInHierarchy&&kt())return}const b=(l=(a=y("Root/UIScene/UICanvas/Popup/PubAutoRecruitSettingView/Content/Popup/Bottom/RemainTimesBox/remainTimesLabel"))==null?void 0:a.getComponent(P.cc.Label))==null?void 0:l.string;if(b&&parseInt(b)===0){De=false;const x=y("Root/UIScene/UICanvas/Popup/PubAutoRecruitSettingView/Content/Popup/Bottom/CloseTips");if(x&&x.active&&x.activeInHierarchy){if(!N.value)return;await m(50),await A(x),await m(500);}return}const S=y("Root/UIScene/UICanvas/Popup/PubAutoRecruitSettingView/Content/Popup/Bottom/BigButtonGreen/Img");if(S&&S.active&&S.activeInHierarchy){if(!N.value)return;await m(50),await A(S),await m(500);continue}const C=y("Root/UIScene/UICanvas/Content/PubMainView/Content/Panel/PubView/Content/Stage/BottomLayout/PubRecruitButtonView/ButtonBox/SettingBox/recruitSettingBtn");if(C&&C.active&&C.activeInHierarchy){if(!N.value)return;await m(50),await A(C),await m(500);continue}await m(200);}},pn={class:"dialog-footer"},vn={class:"dialog-footer"},wn={class:"statisticsContainer"},yn={class:"importLogContainer"},gn={class:"dialog-footer"},hn=vue.defineComponent({__name:"BetCardBtn",setup(t){const e=async()=>{N.value=!N.value,_.log(`自动抽卡: ${N.value?"开":"关"}`),cn();try{for(;N.value;)L("betCardAutoRecruit")&&(await mn(),await m(500)),await fn(),await m(200);}catch(R){_.error(R),N.value=false;}},n=()=>{const R=L("betCardLog")||"";R&&(ut(R),Ot.ElMessage("复制成功"));},a=()=>{H("betCardLog",""),Ot.ElMessage("已清空日志"),ne.value="";};vue.onUnmounted(()=>{N.value=false;});const l=vue.ref(false),o=vue.ref([]),i=vue.ref(false),r=vue.ref("关"),v=vue.ref("300"),s=vue.ref("1800");L("betCardTripleList")||H("betCardTripleList",["quality:红"]),L("betCardAutoRecruit")||H("betCardAutoRecruit",false),L("betCardAutoStop")||H("betCardAutoStop","关"),L("betCardAutoStopCount")||H("betCardAutoStopCount",300),L("betCardAutoStopTime")||H("betCardAutoStopTime",1800);const w=()=>{o.value=L("betCardTripleList"),i.value=L("betCardAutoRecruit"),r.value=L("betCardAutoStop"),v.value=L("betCardAutoStopCount"),s.value=L("betCardAutoStopTime");},b=()=>{H("betCardTripleList",o.value),H("betCardAutoRecruit",i.value),H("betCardAutoStop",r.value),H("betCardAutoStopCount",parseInt(v.value)),H("betCardAutoStopTime",parseInt(s.value)),Ot.ElMessage("设置已保存"),l.value=false;},S=vue.ref(false),C=vue.ref(""),d=()=>{ne.value=C.value,H("betCardLog",ne.value),S.value=false,Ot.ElMessage("已导入日志"),C.value="";},x=()=>{ne.value.trimEnd,ne.value=ne.value.trimEnd()+`
`+C.value.trimStart(),H("betCardLog",ne.value),S.value=false,Ot.ElMessage("已导入日志"),C.value="";},B=vue.ref(false),g=vue.ref(),E=vue.ref(),T=async()=>{var xe;B.value=true,await vue.nextTick();const R=Re__namespace.init(g.value),p={},h={},c=ne.value.split(/\r?\n/);for(let O of c){const j=O.split("	"),le=(xe=j==null?void 0:j[2])==null?void 0:xe.match(/\[\d\]\[(.+?)\]\[(.+?)\]/);if(le){const pe=le[1];p[pe]?p[pe]+=1:p[pe]=1;const te=le[2];h[te]?h[te].value++:h[te]={name:te,quality:pe,value:1};}}const W=["灰","蓝","紫","橙","红"].map(O=>({name:O,value:p[O]||0}));R.setOption({title:{text:"品阶分布",left:"center"},tooltip:{trigger:"item",formatter:O=>`${O.name}: ${O.value}次`},color:["#999999","#0033CC","#9900FF","#FF9900","#FF0000"],legend:{orient:"horizontal",left:"left",bottom:30},series:[{name:"品阶分布",type:"pie",radius:"40%",data:W,label:{show:true,formatter:O=>`${O.name}: ${O.percent}%`},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]});const I=Re__namespace.init(E.value),F=["灰","蓝","紫","橙","红"].map(O=>({name:`品阶: ${O}`,path:`品阶: ${O}`,value:p[O]||0,children:Object.keys(h).filter(j=>h[j].quality===O).map(j=>({name:h[j].name,path:`品阶: ${O}/${h[j].name}`,value:h[j].value}))}));I.setOption({title:{text:"英雄分布",left:"center"},tooltip:{formatter:function(O){for(var j=O.value,le=O.treePathInfo,pe=[],te=1;te<le.length;te++)pe.push(le[te].name);return ['<div class="tooltip-title">'+Re__namespace.format.encodeHTML(pe[pe.length-1])+"</div>","命中: "+Re__namespace.format.addCommas(j)+" 次"].join("")}},series:[{name:"英雄分布",type:"treemap",visibleMin:0,leafDepth:1,drillDownIcon:"",width:"98%",height:"80%",label:{show:true,formatter:"{b}: {c}"},itemStyle:{borderColor:"#fff"},levels:ce(),data:F}]});function ce(){const O={"品阶: 灰":"#999999","品阶: 蓝":"#0033CC","品阶: 紫":"#9900FF","品阶: 橙":"#FF9900","品阶: 红":"#FF0000"};return [{color:F.sort((j,le)=>le.value-j.value).map(j=>O[j.name]),itemStyle:{borderColor:"#777",borderWidth:0,gapWidth:1},upperLabel:{show:false}},{itemStyle:{borderColor:"#555",borderWidth:1,gapWidth:1},emphasis:{itemStyle:{borderColor:"#ddd"}}}]}};return (R,p)=>{const h=vue.resolveComponent("el-button"),c=vue.resolveComponent("el-button-group"),W=vue.resolveComponent("el-tree-select"),I=vue.resolveComponent("el-form-item"),F=vue.resolveComponent("el-switch"),ce=vue.resolveComponent("el-icon"),xe=vue.resolveComponent("el-popover"),O=vue.resolveComponent("el-option"),j=vue.resolveComponent("el-select"),le=vue.resolveComponent("el-input"),pe=vue.resolveComponent("el-form"),te=vue.resolveComponent("el-dialog");return vue.openBlock(),vue.createElementBlock(vue.Fragment,null,[vue.createVNode(c,{class:"group"},{default:vue.withCtx(()=>[vue.createVNode(h,{type:vue.unref(N)?"primary":"default",size:"small",onClick:e},{default:vue.withCtx(()=>[vue.createTextVNode(" 抽卡: "+vue.toDisplayString(vue.unref(N)?"开":"关"),1)]),_:1},8,["type"]),vue.createVNode(h,{size:"small",onClick:p[0]||(p[0]=q=>{w(),l.value=true;})},{default:vue.withCtx(()=>p[16]||(p[16]=[vue.createTextVNode("设置")])),_:1}),vue.createVNode(h,{size:"small",onClick:p[1]||(p[1]=q=>{Se.value=true,ne.value=vue.unref(L)("betCardLog")||"";})},{default:vue.withCtx(()=>p[17]||(p[17]=[vue.createTextVNode("日志")])),_:1})]),_:1}),vue.createVNode(te,{class:"setting-dialog",modelValue:l.value,"onUpdate:modelValue":p[8]||(p[8]=q=>l.value=q),title:"抽卡设置",width:"min(calc(90vw), 450px)"},{footer:vue.withCtx(()=>[vue.createElementVNode("div",pn,[vue.createVNode(h,{size:"small",onClick:b,type:"primary"},{default:vue.withCtx(()=>p[20]||(p[20]=[vue.createTextVNode("保存")])),_:1}),vue.createVNode(h,{size:"small",onClick:p[7]||(p[7]=q=>l.value=false),type:"default"},{default:vue.withCtx(()=>p[21]||(p[21]=[vue.createTextVNode("关闭")])),_:1})])]),default:vue.withCtx(()=>[vue.createVNode(pe,null,{default:vue.withCtx(()=>[vue.createVNode(I,{label:"三倍抽卡清单","label-width":140},{default:vue.withCtx(()=>[vue.createVNode(W,{class:"setting-dialog-select",placeholder:"选择需要三倍抽卡的英雄","check-on-click-node":"",multiple:"","check-strictly":"",modelValue:o.value,"onUpdate:modelValue":p[2]||(p[2]=q=>o.value=q),data:vue.unref(Kt),"render-after-expand":false,"show-checkbox":""},null,8,["modelValue","data"])]),_:1}),vue.createVNode(I,{label:"优先使用自动招募","label-width":140},{default:vue.withCtx(()=>[vue.createVNode(F,{modelValue:i.value,"onUpdate:modelValue":p[3]||(p[3]=q=>i.value=q)},null,8,["modelValue"])]),_:1}),vue.createVNode(I,{"label-width":140},{label:vue.withCtx(()=>[p[19]||(p[19]=vue.createElementVNode("span",null,"自动停止",-1)),vue.createVNode(xe,{placement:"right",width:200,trigger:"hover"},{reference:vue.withCtx(()=>[vue.createVNode(ce,null,{default:vue.withCtx(()=>[vue.createVNode(vue.unref(Tt))]),_:1})]),default:vue.withCtx(()=>[p[18]||(p[18]=vue.createElementVNode("div",null,"自动停止仅针对单抽",-1))]),_:1})]),default:vue.withCtx(()=>[vue.createVNode(j,{modelValue:r.value,"onUpdate:modelValue":p[4]||(p[4]=q=>r.value=q)},{default:vue.withCtx(()=>[(vue.openBlock(true),vue.createElementBlock(vue.Fragment,null,vue.renderList(vue.unref(un),q=>(vue.openBlock(),vue.createBlock(O,{key:q,label:q,value:q},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r.value==="次数"?(vue.openBlock(),vue.createBlock(I,{key:0,label:"抽卡次数","label-width":140},{default:vue.withCtx(()=>[vue.createVNode(le,{type:"number",modelValue:v.value,"onUpdate:modelValue":p[5]||(p[5]=q=>v.value=q)},null,8,["modelValue"])]),_:1})):vue.createCommentVNode("",true),r.value==="时间"?(vue.openBlock(),vue.createBlock(I,{key:1,label:"执行时间(秒)","label-width":140},{default:vue.withCtx(()=>[vue.createVNode(le,{type:"number",modelValue:s.value,"onUpdate:modelValue":p[6]||(p[6]=q=>s.value=q)},null,8,["modelValue"])]),_:1})):vue.createCommentVNode("",true)]),_:1})]),_:1},8,["modelValue"]),vue.createVNode(te,{"before-close":q=>{q(),ne.value="";},class:"bet-card-log",modelValue:vue.unref(Se),"onUpdate:modelValue":p[11]||(p[11]=q=>vue.isRef(Se)?Se.value=q:null),title:"抽卡日志",width:"calc(90vw)"},{footer:vue.withCtx(()=>[vue.createElementVNode("div",vn,[vue.createVNode(h,{size:"small",onClick:T,type:"warning"},{default:vue.withCtx(()=>p[22]||(p[22]=[vue.createTextVNode("统计")])),_:1}),vue.createVNode(h,{size:"small",onClick:p[9]||(p[9]=q=>S.value=true),type:"info"},{default:vue.withCtx(()=>p[23]||(p[23]=[vue.createTextVNode("导入")])),_:1}),vue.createVNode(h,{size:"small",onClick:n,type:"primary"},{default:vue.withCtx(()=>p[24]||(p[24]=[vue.createTextVNode("复制")])),_:1}),vue.createVNode(h,{size:"small",onClick:a,type:"danger"},{default:vue.withCtx(()=>p[25]||(p[25]=[vue.createTextVNode("清空")])),_:1}),vue.createVNode(h,{size:"small",onClick:p[10]||(p[10]=q=>Se.value=false),type:"default"},{default:vue.withCtx(()=>p[26]||(p[26]=[vue.createTextVNode("关闭")])),_:1})])]),default:vue.withCtx(()=>[vue.createElementVNode("pre",{ref_key:"logPreRef",ref:ae},vue.toDisplayString(vue.unref(ne)),513)]),_:1},8,["before-close","modelValue"]),vue.createVNode(te,{"destroy-on-close":"",modelValue:B.value,"onUpdate:modelValue":p[12]||(p[12]=q=>B.value=q),title:"抽卡统计",width:"min(calc(90vw), 450px)"},{default:vue.withCtx(()=>[vue.createElementVNode("div",wn,[vue.createElementVNode("div",{style:{height:"min(calc(50%), 300px)",width:"calc(100%)"},ref_key:"statisticsRef1",ref:g},null,512),vue.createElementVNode("div",{style:{height:"min(calc(50%), 300px)",width:"calc(100%)"},ref_key:"statisticsRef2",ref:E},null,512)])]),_:1},8,["modelValue"]),vue.createVNode(te,{"destroy-on-close":"",modelValue:S.value,"onUpdate:modelValue":p[15]||(p[15]=q=>S.value=q),title:"导入日志",width:"calc(90vw)"},{footer:vue.withCtx(()=>[vue.createElementVNode("div",gn,[vue.createVNode(h,{size:"small",onClick:d,type:"primary"},{default:vue.withCtx(()=>p[27]||(p[27]=[vue.createTextVNode("覆盖导入")])),_:1}),vue.createVNode(h,{size:"small",onClick:x,type:"success"},{default:vue.withCtx(()=>p[28]||(p[28]=[vue.createTextVNode("新增导入")])),_:1}),vue.createVNode(h,{size:"small",onClick:p[14]||(p[14]=q=>{S.value=false,C.value="";}),type:"default"},{default:vue.withCtx(()=>p[29]||(p[29]=[vue.createTextVNode("关闭")])),_:1})])]),default:vue.withCtx(()=>[vue.createElementVNode("div",yn,[vue.createVNode(le,{modelValue:C.value,"onUpdate:modelValue":p[13]||(p[13]=q=>C.value=q),style:{width:"100%",height:"100%"},type:"textarea",placeholder:"请粘贴抽卡日志文本"},null,8,["modelValue"])])]),_:1},8,["modelValue"])],64)}}}),$e=(t,e)=>{const n=t.__vccOpts||t;for(const[a,l]of e)n[a]=l;return n},Cn=$e(hn,[["__scopeId","data-v-c8a59280"]]),fe=vue.ref(false),Rt=async()=>{if(fe.value=!fe.value,_.log(`战神陵打肉: ${fe.value?"开":"关"}`),fe.value){const t=[{x:1533,y:1390},{x:790,y:1518},{x:187,y:1059},{x:-481,y:1265},{x:-1299,y:1188},{x:-1264,y:338},{x:-1188,y:-221},{x:-1032,y:-635},{x:-546,y:-124},{x:390,y:-11},{x:1484,y:-249},{x:1042,y:409},{x:1188,y:1058},{x:1837,y:1706}];try{await Ze(t,!0),fe.value=!1;}catch(e){_.error(e),fe.value=false;}}else J();},bn=vue.defineComponent({__name:"CollectMeatZhanShenLingBtn",setup(t){const e=()=>{Rt();};return vue.onUnmounted(()=>{fe.value=false,J();}),(n,a)=>{const l=vue.resolveComponent("el-button");return vue.openBlock(),vue.createBlock(l,{type:vue.unref(fe)?"primary":"default",size:"small",onClick:e},{default:vue.withCtx(()=>[vue.createTextVNode(" 战神陵打肉: "+vue.toDisplayString(vue.unref(fe)?"开":"关"),1)]),_:1},8,["type"])}}}),Z=vue.ref(false),ht=()=>{var t;return (t=y("/Root/GameScene/GameMapCanvas/MapView/TileMap/unitLayer"))==null?void 0:t.children.filter(e=>{var n,a,l;if(/^Boss/i.test(e.name)){const o=(l=(a=(n=y("AnimBox/Animation/Sprite",e))==null?void 0:n.getComponent(P.cc.Sprite))==null?void 0:a.spriteFrame)==null?void 0:l.name;if(o&&!/[\-_]Die/i.test(o))return  true}return  false}).map(e=>({x:e.position.x,y:e.position.y}))},Lt=async()=>{if(Z.value=!Z.value,_.log(`F4打金币: ${Z.value?"开":"关"}`),Z.value)try{for(;;){if(!Z.value)throw new Error("打金中断");if(await Qe(),await m(200),await Je({type:"teleport",target:["英雄大陆","黑石堡垒","大厅楼道"]}),await Q("Root/GameScene/OperationCanvas/MapButtonView/BuildingButton01"),await m(200),!Z.value)throw new Error("打金中断");await Pe(-10016,-3885);let t=ht();if(!t)throw new Error("boss位置获取失败");let e=ue();if(!e)throw new Error("队伍位置获取失败");let n=Fe(e,t);for(;t!=null&&t.length&&n.length;){const a=Date.now();if(!Z.value)throw new Error("打金中断");if(await Pe(n[0].x,n[0].y),Date.now()-a>300?await m(se(1e3,1500)):await m(se(200,500)),t=ht(),!t)break;if(e=ue(),!e)throw new Error("队伍位置获取失败");n=Fe(e,t);}await m(1e3);}}catch(t){_.error(t),Z.value=false;}else Z.value=false,J();},_n=vue.defineComponent({__name:"CollectGoldenF4Btn",setup(t){const e=async()=>{Lt();};return vue.onUnmounted(()=>{Z.value=false,J();}),(n,a)=>{const l=vue.resolveComponent("el-button");return vue.openBlock(),vue.createBlock(l,{type:vue.unref(Z)?"primary":"default",size:"small",onClick:e},{default:vue.withCtx(()=>[vue.createTextVNode(" F4打金币: "+vue.toDisplayString(vue.unref(Z)?"开":"关"),1)]),_:1},8,["type"])}}}),Pn=vue.defineComponent({__name:"RoamBtn",setup(t){const e=vue.ref(false),n=async()=>{var a;if(e.value=!e.value,e.value)try{for(;;){const l=(a=y("/Root/GameScene/GameMapCanvas/MapView/TileMap/unitLayer"))==null?void 0:a.children.filter(v=>{var s,w,b;if(/^Monster|^Boss/i.test(v.name)){const S=(b=(w=(s=y("AnimBox/Animation/Sprite",v))==null?void 0:s.getComponent(P.cc.Sprite))==null?void 0:w.spriteFrame)==null?void 0:b.name;if(S&&!/[\-_]Die/i.test(S))return !0}return !1}).map(v=>v.position),o=ue();if(!o)throw new Error("队伍位置获取失败");if(!l)throw new Error("怪位置获取失败");const i=Fe(o,l);_.log(i);const r=Math.min(i.length,2);if(r===0)throw new Error("没找到怪");for(let v=0;v<r;v++){const s=Date.now();await Pe(i[v].x,i[v].y),Date.now()-s>300?await m(se(2e3,3e3)):await m(se(200,500));}await m(500);}}catch(l){_.error(l),e.value=false;}else J();};return vue.onUnmounted(()=>{e.value=false,J();}),(a,l)=>{const o=vue.resolveComponent("el-button");return vue.openBlock(),vue.createBlock(o,{type:e.value?"primary":"default",size:"small",onClick:n},{default:vue.withCtx(()=>[vue.createTextVNode(" 智能寻怪: "+vue.toDisplayString(e.value?"开":"关"),1)]),_:1},8,["type"])}}}),Le=[[{x:2048,y:280},{x:1731,y:312},{x:1292,y:-200},{x:724,y:-536},{x:314,y:-806},{x:-271,y:-888},{x:-712,y:-877},{x:-1095,y:-575},{x:-850,y:-198},{x:-620,y:166},{x:-598,y:607},{x:-221,y:522}],[{x:235,y:1292},{x:5,y:727},{x:554,y:392},{x:1143,y:64},{x:567,y:-120},{x:9,y:-401},{x:-464,y:-449},{x:-858,y:-184},{x:-1281,y:73},{x:-1741,y:78}],[{x:455,y:-100},{x:954,y:-155},{x:1454,y:-109},{x:1878,y:-11},{x:2245,y:228},{x:2244,y:490},{x:1835,y:743},{x:1331,y:1053},{x:848,y:1305},{x:354,y:1569},{x:-43,y:1623},{x:-282,y:1238},{x:-752,y:950},{x:-1124,y:931},{x:-460,y:477},{x:-950,y:272}],[{x:1372,y:280},{x:703,y:83},{x:862,y:-293},{x:340,y:-137},{x:484,y:-534},{x:-77,y:-347},{x:-612,y:-544},{x:-914,y:-479},{x:-603,y:-879},{x:-887,y:-990},{x:-509,y:-828},{x:-194,y:-938},{x:329,y:-1115}]],xn=vue.defineComponent({__name:"RoamPathBtn",setup(t){const e=vue.ref(false),n=async()=>{if(e.value=!e.value,e.value)for(;;){if(!e.value)return;for(let a of Le)try{if(_e(a[0].x,a[0].y))try{await Ze(a);}catch(l){_.error(l),e.value=!1;}}catch(l){_.error(l),await m(2e3);}await m(1e3);}else J();};return vue.onUnmounted(()=>{e.value=false,J();}),(a,l)=>{const o=vue.resolveComponent("el-button");return vue.openBlock(),vue.createBlock(o,{type:e.value?"primary":"default",size:"small",onClick:n},{default:vue.withCtx(()=>[vue.createTextVNode(" 预定义路线: "+vue.toDisplayString(e.value?"开":"关"),1)]),_:1},8,["type"])}}}),In=vue.defineComponent({__name:"DungeonBtn",setup(t){const e=vue.ref(false);let n=null,a=false;const l=async()=>{if(e.value=!e.value,n&&clearInterval(n),e.value)try{for(;;){if(!e.value)return;const o=y("Root/UIScene/UICanvas/Popup/DungeonPassView/content/TapHint");if(o&&o.active&&o.activeInHierarchy){if(_.log("副本结束"),n&&(clearInterval(n),n=null),!e.value)return;await A(o),await m(5e3);}if(!e.value)return;const i=y("Root/UIScene/UICanvas/Popup/DungeonCenterView/TabPagePanel/Bg/Panel/Panel1/BtnLayout/BtnEnter");if(await m(2e3),i&&i.active&&i.activeInHierarchy){if(_.log("进入副本"),!e.value||(await A(i),!e.value))return;let r=null;n=setInterval(()=>{var b,S,C,d;const s=(S=(b=y("Root/UIScene/UICanvas/Menu/DungeonMainView/BossNode/BossCount"))==null?void 0:b.getComponent(P.cc.LabelComponent))==null?void 0:S.string,w=(d=(C=y("Root/UIScene/UICanvas/Menu/DungeonMainView/MonsterNode/MonsterCount"))==null?void 0:C.getComponent(P.cc.LabelComponent))==null?void 0:d.string;_.log(`bossProc: ${s}, monsterProc: ${w}`),s==="1/1"&&w==="80/80"&&(a=!0,J());},500);try{r=await Q("Root/UIScene/UICanvas/Popup/CommonGetWayView/BigPopup/closeTip",!0,2e3);}catch{}if(r)throw new Error("未知弹窗");if(!e.value)return;const v=await ot(Le.map(s=>s[0]));if(v===-1)throw new Error("路线未找到");await m(3e3);try{if(!e.value)return;throw _.log("开始副本第一层"),await Ge(Le[v],e),_.log("结束复本第一层"),new Error("通过报错进入副本第二层")}catch(s){if(s instanceof Error&&s.message==="路线未找到"||s instanceof Error&&s.message==="中断本次移动"&&!a)throw s;if(a=!1,!e.value)return;const w=await ot(Le.map(b=>b[0]));if(await m(3e3),w===-1)throw new Error("路线未找到");if(!e.value)return;try{_.log("开始副本第二层"),await Ge(Le[w],e);}catch(b){if(b instanceof Error&&b.message==="路线未找到"||b instanceof Error&&b.message==="中断本次移动"&&!a)throw b;a=!1;}_.log("结束复本第二层");}}await m(1e3);}}catch(o){_.error(o),e.value=false;}else J();};return vue.onUnmounted(()=>{e.value=false,J();}),(o,i)=>{const r=vue.resolveComponent("el-button");return vue.openBlock(),vue.createBlock(r,{type:e.value?"primary":"default",size:"small",onClick:l},{default:vue.withCtx(()=>[vue.createTextVNode(" 召唤副本: "+vue.toDisplayString(e.value?"开":"关"),1)]),_:1},8,["type"])}}}),Sn={class:"dialog-footer"},Vn=vue.defineComponent({__name:"ChestBtn",setup(t){const e=vue.ref(false),n=async()=>{if(e.value=!e.value,e.value)try{for(;;){if(!e.value||(await l(),!e.value))return;await m(1e3);}}catch(C){_.error(C),e.value=false;}};let a=false;async function l(){var d;let C=1;for(;C--;){if(!e.value)return;const x=y("Root/UIScene/UICanvas/Popup/RewardDisplayView/empty/rewardBg/closeTip");if(x&&x.active&&x.activeInHierarchy){if(!e.value)return;if(await A(x),await m(1e3),C)continue;return}if(!e.value)return;const B=y("Root/UIScene/UICanvas/Popup/FunctionChestPreviewView/Panel/TextLayout/TextLeftCount");if(B&&B.active&&B.activeInHierarchy){if(!e.value)return;const E=(d=B.getComponent(P.cc.Label))==null?void 0:d.string;if(!E||!E.includes("/"))throw new Error("获取剩余次数失败");const[T,R]=E.split("/").map(p=>Number(p));if(T===1&&L("AUTOCHEST_REFRESHWHENOVER",false)&&(Ot.ElMessage.info("已达到上限，30秒后刷新页面"),setTimeout(()=>{window.location.reload();},30*1e3)),T>L("AUTOCHEST_LEFTCOUNT",0)){if(!e.value)return;const p=y("Root/UIScene/UICanvas/Popup/FunctionChestPreviewView/Panel/BtnAd");if(L("AUTOCHEST_ADCLAIM",true)&&p&&p.active&&p.activeInHierarchy){if(!e.value)return;await A(p),await m(2e3),C+=2;continue}if(!e.value)return;const h=y("Root/UIScene/UICanvas/Popup/FunctionChestPreviewView/Panel/BtnDirectClaim");if(h&&h.active&&h.activeInHierarchy){if(!e.value)return;await A(h),await m(2e3),C++;continue}if(!e.value)return;const c=y("Root/UIScene/UICanvas/Popup/FunctionChestPreviewView/Panel/BtnClaim");if(c&&c.active&&c.activeInHierarchy){if(!e.value)return;await A(c),await m(2e3),C++;continue}}else throw L("AUTOCHEST_REFRESHWHENOVER",false)&&(Ot.ElMessage.info("已达到剩余次数，5秒后刷新页面"),setTimeout(()=>{window.location.reload();},5*1e3)),new Error("已达到剩余次数上限，不领了")}let g=null;try{if(!e.value)return;g=mt();}catch{}if(g&&ft(["Idle","Gather","Die"]))if(a){if(!e.value)return;await Ke(g),a=false,await m(1e3),C++;continue}else {const E=L("AUTOCHEST_DELAY_LOWER",0),T=L("AUTOCHEST_DELAY_UPPER",0),R=Math.floor(Math.random()*9999999999)%(T-E)+E;R&&Ot.ElMessage(`${R}秒后点击放大镜`),await m(R*1e3),C++,a=true;continue}else C++;await m(1e3);}}const o=vue.ref(false),i=vue.ref(0),r=vue.ref(true),v=vue.ref(false),s=vue.ref("0"),w=vue.ref("0"),b=()=>{i.value=L("AUTOCHEST_LEFTCOUNT",0),r.value=L("AUTOCHEST_ADCLAIM",true),v.value=L("AUTOCHEST_REFRESHWHENOVER",false),s.value=L("AUTOCHEST_DELAY_LOWER","0"),w.value=L("AUTOCHEST_DELAY_UPPER","0"),o.value=true;},S=()=>{H("AUTOCHEST_LEFTCOUNT",i.value),H("AUTOCHEST_ADCLAIM",r.value),H("AUTOCHEST_REFRESHWHENOVER",v.value),H("AUTOCHEST_DELAY_LOWER",parseInt(s.value)),H("AUTOCHEST_DELAY_UPPER",parseInt(w.value)),Ot.ElMessage("设置已保存"),o.value=false;};return vue.onUnmounted(()=>{e.value=false;}),(C,d)=>{const x=vue.resolveComponent("el-button"),B=vue.resolveComponent("el-button-group"),g=vue.resolveComponent("el-input"),E=vue.resolveComponent("el-form-item"),T=vue.resolveComponent("el-switch"),R=vue.resolveComponent("el-col"),p=vue.resolveComponent("el-form"),h=vue.resolveComponent("el-dialog");return vue.openBlock(),vue.createElementBlock(vue.Fragment,null,[vue.createVNode(B,{class:"group"},{default:vue.withCtx(()=>[vue.createVNode(x,{type:e.value?"primary":"default",size:"small",onClick:n},{default:vue.withCtx(()=>[vue.createTextVNode(" 自动开箱: "+vue.toDisplayString(e.value?"开":"关"),1)]),_:1},8,["type"]),vue.createVNode(x,{onClick:b,size:"small"},{default:vue.withCtx(()=>d[7]||(d[7]=[vue.createTextVNode("设置")])),_:1})]),_:1}),vue.createVNode(h,{class:"setting-dialog",modelValue:o.value,"onUpdate:modelValue":d[6]||(d[6]=c=>o.value=c),title:"自动开箱设置",width:"300px"},{footer:vue.withCtx(()=>[vue.createElementVNode("div",Sn,[vue.createVNode(x,{onClick:S,type:"primary"},{default:vue.withCtx(()=>d[9]||(d[9]=[vue.createTextVNode("保存")])),_:1}),vue.createVNode(x,{onClick:d[5]||(d[5]=c=>o.value=false),type:"default"},{default:vue.withCtx(()=>d[10]||(d[10]=[vue.createTextVNode("关闭")])),_:1})])]),default:vue.withCtx(()=>[vue.createVNode(p,{size:"small"},{default:vue.withCtx(()=>[vue.createVNode(E,{label:"留多少次不开","label-width":100},{default:vue.withCtx(()=>[vue.createVNode(g,{modelValue:i.value,"onUpdate:modelValue":d[0]||(d[0]=c=>i.value=c),autocomplete:"off",type:"number"},null,8,["modelValue"])]),_:1}),vue.createVNode(E,{label:"是否开广告","label-width":100},{default:vue.withCtx(()=>[vue.createVNode(T,{modelValue:r.value,"onUpdate:modelValue":d[1]||(d[1]=c=>r.value=c)},null,8,["modelValue"])]),_:1}),vue.createVNode(E,{label:"结束后是否刷新","label-width":100},{default:vue.withCtx(()=>[vue.createVNode(T,{modelValue:v.value,"onUpdate:modelValue":d[2]||(d[2]=c=>v.value=c)},null,8,["modelValue"])]),_:1}),vue.createVNode(E,{label:"开箱延时区间(秒)","label-width":120},{default:vue.withCtx(()=>[vue.createVNode(R,{span:11},{default:vue.withCtx(()=>[vue.createVNode(g,{modelValue:s.value,"onUpdate:modelValue":d[3]||(d[3]=c=>s.value=c),autocomplete:"off",type:"number"},null,8,["modelValue"])]),_:1}),vue.createVNode(R,{span:2},{default:vue.withCtx(()=>d[8]||(d[8]=[vue.createElementVNode("span",null,"~",-1)])),_:1}),vue.createVNode(R,{span:11},{default:vue.withCtx(()=>[vue.createVNode(g,{modelValue:w.value,"onUpdate:modelValue":d[4]||(d[4]=c=>w.value=c),autocomplete:"off",type:"number"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),Bn=$e(Vn,[["__scopeId","data-v-b8add2e3"]]),En=vue.defineComponent({__name:"RedPackBtn",setup(t){const e=vue.ref(false),n=async()=>{if(e.value=!e.value,e.value)for(;;)try{_.log("新一轮等待红包");const a=await Q("Root/UIScene/UICanvas/Menu/MenuView/SaveArea/DownLeft/RedPacketMenuIconView/Btn");if(!e.value)return;if(a){fe.value&&(_.log("检查到正在打肉，20秒后恢复执行打肉"),setTimeout(()=>{fe.value?_.log("打肉正在执行，不恢复"):(_.log("尝试恢复执行打肉"),Rt());},2e4)),Z.value&&(_.log("检查到正在打金，20秒后恢复执行打金"),setTimeout(()=>{Z.value?_.log("打金正在执行，不恢复"):(_.log("尝试恢复执行打金"),Lt());},2e4)),await A(a),await m(500),_.log("抢红包");const o=await Q("Root/UIScene/UICanvas/Popup/ActivityRedPacketOpenView/CommonBG2/packet/bg/openInfo/Hongbao_btn_open",!0,5e3);if(!e.value)return;if(o){await A(o),_.log("打开红包"),await m(800);const i=await Q("Root/UIScene/UICanvas/Popup/ActivityRedPacketOpenView/CommonBG2/CloseTip",!1,2e3);if(!e.value)return;A(i),await m(500),_.log("关闭红包");}}const l=y("Root/UIScene/UICanvas/Popup/ActivityRedPacketOpenView/CommonBG2/packet/bg/hasOpenInfo/status/over");if(!e.value)return;if(l&&l.active){_.log("红包领完了");const o=y("Root/UIScene/UICanvas/Popup/ActivityRedPacketOpenView/CommonBG2/CloseTip");if(!o)throw new Error("closeTipBtn not found");await A(o);}}catch(a){if(_.log(a),await m(1e3),!e.value)return}};return vue.onUnmounted(()=>{e.value=false;}),(a,l)=>{const o=vue.resolveComponent("el-button");return vue.openBlock(),vue.createBlock(o,{type:e.value?"primary":"default",size:"small",onClick:n},{default:vue.withCtx(()=>[vue.createTextVNode(" 自动抢红包: "+vue.toDisplayString(e.value?"开":"关"),1)]),_:1},8,["type"])}}}),Un=vue.defineComponent({__name:"PositionBtn",setup(t){const e=vue.ref("?"),n=vue.ref("?"),a=async()=>{const o=ue();if(!o)throw new Error("队伍位置获取失败");const i=`{ "x": ${Math.floor(o.x)}, "y": ${Math.floor(o.y)} }`;await ut(i),Ot.ElMessage("复制成功："+i);};let l=null;return vue.onMounted(()=>{l=setInterval(()=>{try{const o=ue();o?(e.value=Math.floor(o.x).toString(),n.value=Math.floor(o.y).toString()):(e.value="?",n.value="?");}catch(o){e.value="?",n.value="?",_.error(o);}},1e3);}),vue.onUnmounted(()=>{l&&clearInterval(l);}),(o,i)=>{const r=vue.resolveComponent("el-button");return vue.openBlock(),vue.createBlock(r,{size:"small",onClick:a},{default:vue.withCtx(()=>[vue.createTextVNode(" 坐标: ("+vue.toDisplayString(e.value)+", "+vue.toDisplayString(n.value)+") ",1)]),_:1})}}}),Tn=vue.defineComponent({__name:"FullScreenBtn",setup(t){const e=vue.ref(false),n=()=>{const r=document;return r.fullscreenElement||r.webkitFullscreenElement||r.msFullscreenElement},a=r=>{const v=r;return v.requestFullscreen?v.requestFullscreen():v.webkitRequestFullscreen?v.webkitRequestFullscreen():v.msRequestFullscreen?v.msRequestFullscreen():Promise.reject("不支持全屏API")},l=()=>{const r=document;return r.exitFullscreen?r.exitFullscreen():r.webkitExitFullscreen?r.webkitExitFullscreen():r.msExitFullscreen?r.msExitFullscreen():Promise.reject("不支持退出全屏API")},o=()=>{e.value=!!n();};vue.onMounted(()=>{document.addEventListener("fullscreenchange",o),document.addEventListener("webkitfullscreenchange",o),document.addEventListener("MSFullscreenChange",o);}),vue.onUnmounted(()=>{document.removeEventListener("fullscreenchange",o),document.removeEventListener("webkitfullscreenchange",o),document.removeEventListener("MSFullscreenChange",o);});const i=async()=>{try{n()?(await l(),e.value=!1):(await a(document.documentElement),e.value=!0);}catch(r){console.error("全屏错误:",r),Ot.ElMessage.error(`全屏错误：${r}`);}};return (r,v)=>{const s=vue.resolveComponent("el-button");return vue.openBlock(),vue.createBlock(s,{type:e.value?"primary":"default",size:"small",onClick:i},{default:vue.withCtx(()=>[vue.createTextVNode(" 全屏: "+vue.toDisplayString(e.value?"开":"关"),1)]),_:1},8,["type"])}}}),Mn=vue.defineComponent({__name:"BuildWoodenBoard",setup(t){const e=vue.ref(false),n=vue.ref(false),a=async()=>{if(!e.value){e.value=true;try{const o=y("bgParent/PlankLightItem/content/01",y("Root/UIScene/UICanvas/Popup/ActivityBuildPlankMainView/parent/bg/plankContent/moveParent/platformParent").children[0]),i=y("Root/UIScene/UICanvas/Popup/ActivityBuildPlankMainView/parent/bg/plankContent/moveParent/plankParent").children;let r=null;for(let d of i)if(r=d,!y("content/hor/1",r).active)break;const{x:v,y:s}=y("content/hor/1",r).worldPosition,{x:w,y:b}=y("content/hor/2",r).worldPosition,S=(s-b)/(v-w),C=ve(o);he(C.x,C.y),await m(200),await new Promise((d,x)=>{const B=Date.now();let g=!1,E=0,T={x:o.worldPosition.x,y:o.worldPosition.y};const R=setInterval(()=>{Date.now()-B>5e3&&(clearInterval(R),Ot.ElMessage.error("超时未确认到合适的点"),x()),y("bgParent/PlankLightItem/content/01",y("Root/UIScene/UICanvas/Popup/ActivityBuildPlankMainView/parent/bg/plankContent/moveParent/platformParent").children[0]);const p={x:o.worldPosition.x,y:o.worldPosition.y};(Math.abs(p.x-T.x)>1||Math.abs(p.y-T.y)>1)&&(g=!0,E=(p.y-T.y)/(p.x-T.x));let h=null,c=9999999999;const W=y("content/hor",r).children;for(let I of W){const F=I,ce={x:F.children[0].worldPosition.x,y:F.children[0].worldPosition.y},xe=Math.abs(ce.x-p.x+S*(ce.y-p.y))/Math.sqrt(1+S**2);xe<c&&(c=xe,h=F.name);}if(_.log(`minName: ${h}, minDistance: ${c}, isMovePlatform: ${g}, woodK: ${S}, platformK: ${E}`),!g||g&&c<30){const I=y(`content/vec/${h}`,r);I!=null&&I.active&&(clearInterval(R),Ot.ElMessage(`${h}个木板`),d());}},20);}),me(C.x,C.y),e.value=!1;}catch(o){_.error(o),e.value=false;}}},l=async()=>{if(!n.value){n.value=true;try{const o=y("bgParent/PlankLightItem/content/01",y("Root/UIScene/UICanvas/Popup/ActivityBuildPlankMainView/parent/bg/plankContent/moveParent/platformParent").children[0]),i=ve(o);he(i.x,i.y),await m(10),me(i.x,i.y),await m(200),he(i.x,i.y),await m(10),me(i.x,i.y),await m(200),he(i.x,i.y),await m(10),me(i.x,i.y),await m(200),n.value=!1;}catch(o){_.error(o),n.value=false;}}};return vue.onUnmounted(()=>{e.value=false,n.value=false;}),(o,i)=>{const r=vue.resolveComponent("el-button"),v=vue.resolveComponent("el-button-group");return vue.openBlock(),vue.createBlock(v,{class:"group"},{default:vue.withCtx(()=>[vue.createVNode(r,{type:e.value?"primary":"default",size:"small",onClick:a},{default:vue.withCtx(()=>[vue.createTextVNode(" 搭木板: "+vue.toDisplayString(e.value?"开":"关"),1)]),_:1},8,["type"]),vue.createVNode(r,{type:n.value?"primary":"default",size:"small",onClick:l},{default:vue.withCtx(()=>[vue.createTextVNode(" 三连击: "+vue.toDisplayString(n.value?"开":"关"),1)]),_:1},8,["type"])]),_:1})}}}),kn=$e(Mn,[["__scopeId","data-v-35e5bcc4"]]),Rn=vue.defineComponent({__name:"CenterPointBtn",setup(t){const e=vue.ref(false),n=()=>{e.value=!e.value;};return vue.watch(e,a=>{if(a){if(!document.querySelector(".centerPoint")){const o=document.createElement("span");o.className="centerPoint",document.body.appendChild(o);}}else {const l=document.querySelector(".centerPoint");l&&l.remove();}}),vue.onUnmounted(()=>{e.value=false;}),(a,l)=>{const o=vue.resolveComponent("el-button");return vue.openBlock(),vue.createBlock(o,{type:e.value?"primary":"default",size:"small",onClick:n},{default:vue.withCtx(()=>[vue.createTextVNode(" 中心点显示: "+vue.toDisplayString(e.value?"开":"关"),1)]),_:1},8,["type"])}}}),Ln={class:"dialog-footer"},An=vue.defineComponent({__name:"NormalArenaBtn",setup(t){const e=["仅免费进攻","进攻次数"],n=vue.ref(false),a=vue.ref(false),l=vue.ref("仅免费进攻"),o=vue.ref("10"),i=vue.ref("1800"),r=vue.ref(0),v=async()=>{n.value?n.value=false:(r.value=0,w());},s=()=>{const C=y("Root/UIScene/UICanvas/Popup/ArenaMainView/parent/NormalArenaMainView/parent/downContent/bg/listView/view/content");return C?C.children.map(d=>{const x=y("content/bg/scoreBg/scoreNum",d),B=y("content/bg/freeBtn",d),g=y("content/bg/attackBtn",d);let E=null,T=null;return B!=null&&B.active&&(B!=null&&B.activeInHierarchy)&&(E=B,T="free"),g!=null&&g.active&&(g!=null&&g.activeInHierarchy)&&(E=g,T=`${y("attackNumText",g).getComponent(P.cc.LabelComponent).string}`),{score:parseInt(x.getComponent(P.cc.LabelComponent).string),attackBtn:E,type:T}}).sort((d,x)=>d.score>x.score?1:-1):[]},w=async()=>{var C,d;for(n.value=true;n.value;){if(rn()){await m(500);continue}const x=y("Root/UIScene/UICanvas/Popup/ArenaMainView/parent/NormalArenaMainView/parent/downContent/bg/rankBg/rankText");if(x!=null&&x.active&&(x!=null&&x.activeInHierarchy)){const g=(C=x.getComponent(P.cc.LabelComponent))==null?void 0:C.string;await m(200);const E=(d=x.getComponent(P.cc.LabelComponent))==null?void 0:d.string;if(g===E){const T=s(),R=T[T.length-1];if(L("NormalArena_attackMode","仅免费进攻")==="仅免费进攻")if(R.type==="free"){await A(R.attackBtn),await m(3e3);continue}else {n.value=false,Ot.ElMessage("免费次数已使用完"),_.log("免费次数已使用完");return}else if(L("NormalArena_attackMode")==="进攻次数")if(r.value>=L("NormalArena_attackCount",10)){n.value=false,Ot.ElMessage(`进攻次数已达${r.value}，结束进攻`),_.log(`进攻次数已达${r.value}，结束进攻`);return}else {await A(R.attackBtn),await m(3e3);continue}}}const B=y("Root/UIScene/UICanvas/Popup/Modal_ArenaBattleResultView");if(B!=null&&B.active&&(B!=null&&B.activeInHierarchy)){await A(B),await m(100),await A(B),await m(1e3),r.value++;continue}await m(500);}},b=async()=>{l.value=L("NormalArena_attackMode","仅免费进攻"),o.value=""+L("NormalArena_attackCount",10),i.value=""+L("NormalArena_targetScore",1800);},S=async()=>{H("NormalArena_attackMode",l.value),H("NormalArena_attackCount",parseInt(o.value)),H("NormalArena_targetScore",parseInt(i.value)),Ot.ElMessage("设置已保存"),a.value=false;};return vue.onUnmounted(()=>{n.value=false;}),(C,d)=>{const x=vue.resolveComponent("el-button"),B=vue.resolveComponent("el-button-group"),g=vue.resolveComponent("el-option"),E=vue.resolveComponent("el-select"),T=vue.resolveComponent("el-form-item"),R=vue.resolveComponent("el-input"),p=vue.resolveComponent("el-form"),h=vue.resolveComponent("el-dialog");return vue.openBlock(),vue.createElementBlock(vue.Fragment,null,[vue.createVNode(B,{class:"group"},{default:vue.withCtx(()=>[vue.createVNode(x,{type:n.value?"primary":"default",size:"small",onClick:v},{default:vue.withCtx(()=>[vue.createTextVNode(" 自动竞技场: "+vue.toDisplayString(n.value?"开":"关"),1)]),_:1},8,["type"]),vue.createVNode(x,{size:"small",onClick:d[0]||(d[0]=c=>{b(),a.value=true;})},{default:vue.withCtx(()=>d[6]||(d[6]=[vue.createTextVNode("设置")])),_:1})]),_:1}),vue.createVNode(h,{class:"setting-dialog",modelValue:a.value,"onUpdate:modelValue":d[5]||(d[5]=c=>a.value=c),title:"自动竞技场设置",width:"min(calc(90vw), 450px)"},{footer:vue.withCtx(()=>[vue.createElementVNode("div",Ln,[vue.createVNode(x,{size:"small",onClick:S,type:"primary"},{default:vue.withCtx(()=>d[7]||(d[7]=[vue.createTextVNode("保存")])),_:1}),vue.createVNode(x,{size:"small",onClick:d[4]||(d[4]=c=>a.value=false),type:"default"},{default:vue.withCtx(()=>d[8]||(d[8]=[vue.createTextVNode("关闭")])),_:1})])]),default:vue.withCtx(()=>[vue.createVNode(p,null,{default:vue.withCtx(()=>[vue.createVNode(T,{label:"进攻模式","label-width":140},{default:vue.withCtx(()=>[vue.createVNode(E,{class:"setting-dialog-select",placeholder:"选择进攻模式",modelValue:l.value,"onUpdate:modelValue":d[1]||(d[1]=c=>l.value=c)},{default:vue.withCtx(()=>[(vue.openBlock(),vue.createElementBlock(vue.Fragment,null,vue.renderList(e,c=>vue.createVNode(g,{label:c,value:c},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l.value==="进攻次数"?(vue.openBlock(),vue.createBlock(T,{key:0,label:"进攻次数","label-width":140},{default:vue.withCtx(()=>[vue.createVNode(R,{type:"number",modelValue:o.value,"onUpdate:modelValue":d[2]||(d[2]=c=>o.value=c)},null,8,["modelValue"])]),_:1})):vue.createCommentVNode("",true),l.value==="目标分数"?(vue.openBlock(),vue.createBlock(T,{key:1,label:"目标分数","label-width":140},{default:vue.withCtx(()=>[vue.createVNode(R,{type:"number",modelValue:i.value,"onUpdate:modelValue":d[3]||(d[3]=c=>i.value=c)},null,8,["modelValue"])]),_:1})):vue.createCommentVNode("",true)]),_:1})]),_:1},8,["modelValue"])],64)}}}),$n=$e(An,[["__scopeId","data-v-9e5bca3f"]]),it=[{id:"BetCardBtn",component:Cn,name:"自动抽卡",description:"可以进行自动抽卡"},{id:"BuildWoodenBoard",component:kn,name:"搭木板",description:"勇闯火焰山活动，运行一次搭一次木板，只能在静态平台时运行，否则会计算错误"},{id:"CollectMeatZhanShenLingBtn",component:bn,name:"自动打肉（战神陵）",description:"在无尽深渊-熔火之境-战神陵绕圈打肉"},{id:"CollectGoldenF4Btn",component:_n,name:"自动打金币（F4）",description:"在英雄大陆-黑石堡垒-大厅楼道打4个boss获取金币、也可以在这里刷经验"},{id:"RoamBtn",component:Pn,name:"智能寻怪",description:"实验性功能，查找附近的boss和小怪，并自动规划路线打怪，目前无法避障",hideInLite:true},{id:"RoamPathBtn",component:xn,name:"预定义路线",description:"实验性功能，启动时获取当前坐标与已知路线的起点比较，若匹配则以该路线进行行进",hideInLite:true},{id:"DungeonBtn",component:In,name:"召唤副本",description:"打100级的召唤副本，打开召唤副本界面，选择好难度后运行可自动打副本，根据已知路线与附近怪物动动态实时规划路线，可保证任意阵容不漏怪打副本"},{id:"ChestBtn",component:Bn,name:"自动开箱",description:"原地自动领宝箱，一般用于挂机boss领宝箱"},{id:"NormalArenaBtn",component:$n,name:"自动荣耀竞技场",description:"自动打荣耀竞技场，可选择打免费的或打指定次数或打到目标分数"},{id:"RedPackBtn",component:En,name:"自动抢红包",description:"实时查找左下角红包按钮，出现了就抢红包，不一定能抢到"},{id:"FullScreenBtn",component:Tn,name:"全屏",description:"点击后申请全屏，以便移动端可以全屏游玩"},{id:"CenterPointBtn",component:Rn,name:"显示中心点",description:"中心点显示辅助，开启后显示队伍中心"},{id:"PositionBtn",component:Un,name:"坐标显示",description:"显示当前坐标，点击后可复制坐标，一般用于路线制作时的坐标获取"}],qn=()=>{const t=vue.ref(false);return {status:t,start:async n=>{if(t.value=!t.value,_.log(`动态路线[${n.name}]: ${t.value?"开":"关"}`),t.value){const a=n.path;try{n.dynamicMonster?await Ge(a,t,n.isCircle):await Ze(a,n.isCircle),t.value=!1;}catch(l){_.error(l),t.value=false;}}else J();}}},Nn=vue.defineComponent({__name:"DynamicPathBtn",props:{id:String},setup(t,{expose:e}){const{start:n,status:a}=qn(),l=t,o=vue.ref();vue.onMounted(()=>{i();}),vue.onUnmounted(()=>{a.value=false,J();});const i=()=>{if(J(),!l.id)throw Error("dynamic path btn id cannot be null");const v=Dn(l.id);if(!v)throw Error(`dynamic path [${l.id}] cannot be resolved`);o.value=v;},r=()=>{if(!o.value)throw Error(`dynamic path [${l.id}] cannot be resolved`);_.log("dynamic path config: ",o.value),n(o.value);};return e({loadConfig:i}),(v,s)=>{const w=vue.resolveComponent("el-button");return vue.openBlock(),vue.createBlock(w,{type:vue.unref(a)?"primary":"default",size:"small",onClick:r},{default:vue.withCtx(()=>{var b;return [vue.createTextVNode(vue.toDisplayString(((b=o.value)==null?void 0:b.name)||"动态按钮unkown")+": "+vue.toDisplayString(vue.unref(a)?"开":"关"),1)]}),_:1},8,["type"])}}}),rt="component_config";function Hn(){return it.reduce((t,e)=>(t[e.id]={visible:true,order:it.indexOf(e)},t),{})}function qe(){let t=Hn();_.log("defaultConfig",t);let e=L(rt,null);return e||(e=t,H(rt,e)),e={...t,...e},_.log("savedConfig",e),e}function Dn(t){return qe()[t]||null}function On(t){const n={...qe()};for(const[a,l]of Object.entries(t))n[a]&&(n[a]={...n[a],...l});H(rt,n);}function At(t=true){const e=qe();return Object.keys(e).sort((n,a)=>e[n].order-e[a].order).map(n=>{const a=e[n];if(a.path)return {component:Nn,...a};{const l=it.find(o=>o.id===n);return l||(_.warn(`Component ${n} not found in funComponents`),null)}}).filter(n=>n?!t||t&&("hideInLite"in n?!n.hideInLite:true):false)}const $t="component_config";function Fn(t){const e=qt();_.log("config",e);let n=0;Object.keys(e).forEach(a=>{const l=t.find(o=>o.id===a);l?e[a]={...e[a],...l}:e[a].path&&delete e[a],e[a]&&n<e[a].order&&(n=e[a].order);}),t.forEach(a=>{e[a.id]||(e[a.id]={visible:false,order:n+1,...a});}),H($t,e);}function zn(){const t=qt();return Object.keys(t).filter(e=>{var n;return (n=t[e])==null?void 0:n.path}).map(e=>{const n=t[e];return {id:n.id,name:n.name,description:n.description,path:n.path,isCircle:n.isCircle,dynamicMonster:n.dynamicMonster}})}function qt(){return L($t,{})}const Gn={class:"dialog-content"},Wn={class:"settings-list"},Yn=["data-id"],Xn={class:"name-text"},Kn={style:{"text-align":"right",margin:"0"}},jn=vue.defineComponent({__name:"ButtonSetting",props:{isLite:Boolean},emits:["saved"],setup(t,{emit:e}){const n=t,a=vue.ref([]),l=vue.ref("buttons"),o=vue.ref([]),i=vue.ref(null),r=vue.ref(false),v=vue.ref([]),s=vue.ref(false),w=vue.ref({}),b=vue.ref(window.innerWidth<=450);window.addEventListener("resize",()=>{b.value=window.innerWidth<=450;});const S=()=>{C(),s.value=true;},C=()=>{const h=qe();a.value=At(n.isLite),o.value=zn(),v.value=new Array(o.value.length).fill(false),a.value.forEach(c=>{var W,I;w.value[c.id]={visible:((W=h[c.id])==null?void 0:W.visible)??false,order:((I=h[c.id])==null?void 0:I.order)??a.value.indexOf(c),name:c.name,description:c.description};});},d=e,x=()=>{try{Fn(o.value),C(),d("saved"),Ot.ElMessage.success("路线保存成功");}catch(h){_.error("动态路线保存失败:",h),Ot.ElMessage.error("动态路线保存失败");}},B=()=>{i.value={id:`dynamic_${Date.now()}`,name:"",description:"",path:[],pathStr:"[]",isCircle:false,dynamicMonster:false},r.value=true;},g=h=>{const c=JSON.parse(JSON.stringify(o.value[h]));c._index=h,c.pathStr=`[
${c.path.map(W=>`	${JSON.stringify(W)}`).join(`,
`)}
]`,c.id||(c.id=`dynamic_${Date.now()}`),i.value=c,r.value=true;},E=h=>{o.value.splice(h,1),x();},T=()=>{if(i.value)try{const h={...i.value};h.id||(h.id=`dynamic_${Date.now()}`),h.path=JSON.parse(i.value.pathStr||"[]"),delete h._index,delete h.pathStr,i.value._index!==void 0?o.value[i.value._index]=h:o.value.push(h),r.value=!1,x();}catch{Ot.ElMessage.error("路线配置JSON格式错误");}},R=()=>{const h={};Object.entries(w.value).forEach(([c,W])=>{h[c]={visible:W.visible,order:W.order};}),On(h),s.value=false,d("saved");},p=()=>{vue.nextTick(()=>{const h=document.querySelector(".settings-list");h&&!h.getAttribute("data-sortable-initialized")&&(Yt.create(h,{animation:150,handle:".drag-handle",onEnd:c=>{Array.from(h.children).forEach((I,F)=>{const ce=I.getAttribute("data-id");ce&&(w.value[ce].order=F);});}}),h.setAttribute("data-sortable-initialized","true"));});};return vue.watch(s,h=>{h&&p();}),(h,c)=>{const W=vue.resolveComponent("el-button-group");return vue.openBlock(),vue.createElementBlock(vue.Fragment,null,[vue.createVNode(vue.unref(Ot.ElButton),{size:"small",onClick:S},{default:vue.withCtx(()=>c[10]||(c[10]=[vue.createTextVNode("按钮设置")])),_:1}),vue.createVNode(vue.unref(Ot.ElDialog),{modelValue:s.value,"onUpdate:modelValue":c[9]||(c[9]=I=>s.value=I),title:"按钮设置",width:"400px",fullscreen:b.value,"append-to-body":""},{footer:vue.withCtx(()=>[l.value==="buttons"?(vue.openBlock(),vue.createElementBlock("div",{key:0,style:vue.normalizeStyle(b.value?"text-align: center":"")},[vue.createVNode(vue.unref(Ot.ElButton),{onClick:c[8]||(c[8]=I=>s.value=false)},{default:vue.withCtx(()=>c[20]||(c[20]=[vue.createTextVNode("取消")])),_:1}),vue.createVNode(vue.unref(Ot.ElButton),{type:"primary",onClick:R},{default:vue.withCtx(()=>c[21]||(c[21]=[vue.createTextVNode("保存")])),_:1})],4)):vue.createCommentVNode("",true)]),default:vue.withCtx(()=>[vue.createElementVNode("div",Gn,[vue.createVNode(vue.unref(Ot.ElTabs),{modelValue:l.value,"onUpdate:modelValue":c[7]||(c[7]=I=>l.value=I)},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(Ot.ElTabPane),{label:"按钮选择",name:"buttons"},{default:vue.withCtx(()=>[vue.createElementVNode("div",Wn,[(vue.openBlock(true),vue.createElementBlock(vue.Fragment,null,vue.renderList(a.value,I=>{var F;return vue.openBlock(),vue.createElementBlock("div",{key:I.id,class:"setting-item","data-id":I.id,style:vue.normalizeStyle({opacity:(F=w.value[I.id])!=null&&F.visible?1:.6})},[c[11]||(c[11]=vue.createElementVNode("div",{class:"drag-handle"},"≡",-1)),vue.createVNode(vue.unref(Ot.ElCheckbox),{modelValue:w.value[I.id].visible,"onUpdate:modelValue":ce=>w.value[I.id].visible=ce},null,8,["modelValue","onUpdate:modelValue"]),vue.createElementVNode("span",Xn,vue.toDisplayString(w.value[I.id].name||I.id),1),I.description?(vue.openBlock(),vue.createBlock(vue.unref(Ot.ElPopover),{key:0,placement:"top",width:200,trigger:"hover"},{reference:vue.withCtx(()=>[vue.createVNode(vue.unref(Ot.ElButton),{size:"small",circle:""},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(Ot.ElIcon),null,{default:vue.withCtx(()=>[vue.createVNode(vue.unref(Tt))]),_:1})]),_:1})]),default:vue.withCtx(()=>[vue.createElementVNode("div",null,vue.toDisplayString(w.value[I.id].description),1)]),_:2},1024)):vue.createCommentVNode("",true)],12,Yn)}),128))])]),_:1}),vue.createVNode(vue.unref(Ot.ElTabPane),{label:"动态路线",name:"paths"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(Ot.ElButton),{type:"primary",onClick:B,size:"small",style:{float:"right","margin-bottom":"5px"}},{default:vue.withCtx(()=>c[12]||(c[12]=[vue.createTextVNode("添加路线")])),_:1}),vue.createVNode(vue.unref(Ot.ElTable),{data:o.value,border:""},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(Ot.ElTableColumn),{prop:"name",label:"名称"}),vue.createVNode(vue.unref(Ot.ElTableColumn),{prop:"isCircle",label:"循环",align:"center",width:"60"},{default:vue.withCtx(({row:I})=>[vue.createVNode(vue.unref(Ot.ElCheckbox),{modelValue:I.isCircle,"onUpdate:modelValue":F=>I.isCircle=F,disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),vue.createVNode(vue.unref(Ot.ElTableColumn),{prop:"dynamicMonster",align:"center",label:"动态打怪",width:"60"},{default:vue.withCtx(({row:I})=>[vue.createVNode(vue.unref(Ot.ElCheckbox),{modelValue:I.dynamicMonster,"onUpdate:modelValue":F=>I.dynamicMonster=F,disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),vue.createVNode(vue.unref(Ot.ElTableColumn),{label:"操作",align:"center",width:"120"},{default:vue.withCtx(({$index:I})=>[vue.createVNode(W,null,{default:vue.withCtx(()=>[vue.createVNode(vue.unref(Ot.ElButton),{size:"small",onClick:F=>g(I)},{default:vue.withCtx(()=>c[13]||(c[13]=[vue.createTextVNode("编辑")])),_:2},1032,["onClick"]),vue.createVNode(vue.unref(Ot.ElPopover),{visible:v.value[I],placement:"top",width:"160"},{reference:vue.withCtx(()=>[vue.createVNode(vue.unref(Ot.ElButton),{size:"small",type:"danger",onClick:F=>v.value[I]=true},{default:vue.withCtx(()=>c[14]||(c[14]=[vue.createTextVNode(" 删除 ")])),_:2},1032,["onClick"])]),default:vue.withCtx(()=>[c[17]||(c[17]=vue.createElementVNode("p",null,"是否删除？",-1)),vue.createElementVNode("div",Kn,[vue.createVNode(vue.unref(Ot.ElButton),{size:"small",onClick:F=>v.value[I]=false},{default:vue.withCtx(()=>c[15]||(c[15]=[vue.createTextVNode("取消")])),_:2},1032,["onClick"]),vue.createVNode(vue.unref(Ot.ElButton),{size:"small",type:"danger",onClick:F=>{E(I),v.value[I]=false;}},{default:vue.withCtx(()=>c[16]||(c[16]=[vue.createTextVNode("确定")])),_:2},1032,["onClick"])])]),_:2},1032,["visible"])]),_:2},1024)]),_:1})]),_:1},8,["data"]),vue.createVNode(vue.unref(Ot.ElDialog),{modelValue:r.value,"onUpdate:modelValue":c[6]||(c[6]=I=>r.value=I),title:"路线配置",width:"min(calc(90vw), 400px)"},{footer:vue.withCtx(()=>[vue.createVNode(vue.unref(Ot.ElButton),{onClick:c[5]||(c[5]=I=>r.value=false)},{default:vue.withCtx(()=>c[18]||(c[18]=[vue.createTextVNode("取消")])),_:1}),vue.createVNode(vue.unref(Ot.ElButton),{type:"primary",onClick:T},{default:vue.withCtx(()=>c[19]||(c[19]=[vue.createTextVNode("保存")])),_:1})]),default:vue.withCtx(()=>[i.value?(vue.openBlock(),vue.createBlock(vue.unref(Ot.ElForm),{key:0,"label-width":"100px"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(Ot.ElFormItem),{class:"dynamic-btn-form-item",label:"名称"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(Ot.ElInput),{modelValue:i.value.name,"onUpdate:modelValue":c[0]||(c[0]=I=>i.value.name=I)},null,8,["modelValue"])]),_:1}),vue.createVNode(vue.unref(Ot.ElFormItem),{class:"dynamic-btn-form-item",label:"描述"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(Ot.ElInput),{modelValue:i.value.description,"onUpdate:modelValue":c[1]||(c[1]=I=>i.value.description=I),type:"textarea",rows:2},null,8,["modelValue"])]),_:1}),vue.createVNode(vue.unref(Ot.ElFormItem),{class:"dynamic-btn-form-item",label:"属性"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(Ot.ElCheckbox),{label:"是否循环",modelValue:i.value.isCircle,"onUpdate:modelValue":c[2]||(c[2]=I=>i.value.isCircle=I)},null,8,["modelValue"]),vue.createVNode(vue.unref(Ot.ElCheckbox),{label:"动态打怪",modelValue:i.value.dynamicMonster,"onUpdate:modelValue":c[3]||(c[3]=I=>i.value.dynamicMonster=I)},null,8,["modelValue"])]),_:1}),vue.createVNode(vue.unref(Ot.ElFormItem),{class:"dynamic-btn-form-item",label:"路线配置(JSON)"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(Ot.ElInput),{modelValue:i.value.pathStr,"onUpdate:modelValue":c[4]||(c[4]=I=>i.value.pathStr=I),type:"textarea",rows:8},null,8,["modelValue"])]),_:1})]),_:1})):vue.createCommentVNode("",true)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["modelValue","fullscreen"])],64)}}}),Jn=vue.defineComponent({__name:"PathViewer",setup(t){return (e,n)=>{const a=vue.resolveComponent("el-dialog");return vue.openBlock(),vue.createBlock(a,{class:"path-viewer","modal-class":"path-viewer-modal",top:"0px",modelValue:vue.unref(Ae),"onUpdate:modelValue":n[0]||(n[0]=l=>vue.isRef(Ae)?Ae.value=l:null),modal:false,"show-close":true,draggable:"",width:"200px","destroy-on-close":"","close-on-click-modal":false},{header:vue.withCtx(()=>n[1]||(n[1]=[vue.createElementVNode("span",null,"线路图",-1)])),footer:vue.withCtx(()=>n[2]||(n[2]=[])),default:vue.withCtx(()=>[vue.createElementVNode("div",{ref_key:"echartsRef",ref:Pt,style:{width:"200px",height:"200px"}},"echarts显示区域",512)]),_:1},8,["modelValue"])}}}),Zn={class:"zz-sub-btns"},Qn=vue.defineComponent({__name:"App",props:{isLite:Boolean},setup(t){const e=vue.ref(),n=vue.ref(),a=vue.shallowRef([]),l=vue.ref({}),o=vue.ref({});vue.onMounted(()=>{v();});const i=()=>{var w,b;(w=e.value)==null||w.classList.toggle("zz-show"),(b=n.value)==null||b.classList.toggle("zz-rotate");},r=()=>{var w,b;n.value.style.display="none",(w=e.value)==null||w.classList.toggle("zz-show"),(b=n.value)==null||b.classList.toggle("zz-rotate"),setTimeout(()=>{n.value.style.display="block";},5e3);},v=()=>{o.value={},a.value=At(s.isLite),l.value=qe(),vue.nextTick(()=>{_.log("dynamicPathBtnRefs.value",o.value),vue.nextTick(()=>{Object.values(o.value).forEach(w=>{_.log(w),w==null||w.loadConfig();});});});},s=t;return (w,b)=>{const S=vue.resolveComponent("el-button-group");return vue.openBlock(),vue.createElementBlock("div",{ref_key:"btnContainer",ref:e,class:"zz-float-container"},[vue.createElementVNode("div",{ref_key:"btn",ref:n,onClick:i,class:"zz-float-btn",role:"button",tabindex:"0"},"+",512),vue.createElementVNode("div",Zn,[(vue.openBlock(true),vue.createElementBlock(vue.Fragment,null,vue.renderList(a.value,C=>{var d;return vue.openBlock(),vue.createElementBlock(vue.Fragment,null,[(d=l.value[C.id])!=null&&d.visible?(vue.openBlock(),vue.createBlock(vue.resolveDynamicComponent(C.component),{key:C.id,id:C.id,ref_for:true,ref:x=>{var B;(B=l.value[C.id])!=null&&B.path&&(o.value[C.id]=x);}},null,8,["id"])):vue.createCommentVNode("",true)],64)}),256)),vue.createVNode(S,{class:"group"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(Ot.ElButton),{size:"small",onClick:r},{default:vue.withCtx(()=>b[0]||(b[0]=[vue.createTextVNode("临时隐藏")])),_:1}),vue.createVNode(jn,{"is-lite":t.isLite,onSaved:v},null,8,["is-lite"])]),_:1})]),vue.createVNode(Jn)],512)}}}),ea=$e(Qn,[["__scopeId","data-v-ee34aa69"]]);vue.createApp(ea,{isLite:true}).use(Ot,{zIndex:4e3}).mount((()=>{const t=document.createElement("div");return document.body.append(t),t})());

})(Vue, ElementPlus, echarts, Sortable);